<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[Access-小示例-02-连接mdb数据库]]></title>
      <url>/2023/08/01/Access-%E5%B0%8F%E7%A4%BA%E4%BE%8B-02-%E8%BF%9E%E6%8E%A5mdb%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>目录</p>
<p>Part 1：本篇目标</p>
<ol>
<li>常用Access数据库格式为<em><strong>accdb</strong></em>，近来发现一种<em><strong>mdb</strong></em>数据格式的</li>
<li>作为数据库端，本文就是验证一下两者在使用<em><strong>VBA</strong></em>连接时是否有一些明显区别</li>
<li>示例：连接***mdb***数据库，并将内容显示到前端</li>
</ol>
<p><strong>mdb数据库</strong></p>
<p><img src="/./../img/640-1690880578432-390.png" alt="图片"></p>
<p><strong>前端效果</strong></p>
<p><img src="/./../img/640-1690880578433-391.gif" alt="图片"></p>
<hr>
<p>目录</p>
<p>Part 2：实现步骤</p>
<ol>
<li><p>新建一个<em><strong>Access</strong></em>文件，默认为<em><strong>accdb</strong></em>格式，转变为<em><strong>mdb</strong></em>格式步骤如下</p>
</li>
<li><ul>
<li>打开该文件，点击<strong>文件</strong>菜单，另存为<strong>mdb</strong>格式即可</li>
<li>在该文件中录入相关信息</li>
</ul>
</li>
<li><p>再新建一个<strong>Access</strong>文件，作为界面端，<strong>VBA</strong>代码也是写在这里</p>
</li>
<li><ul>
<li>搭建一个简单界面，包括一个按钮和一个列表框</li>
<li>设计视图下，设置列表框的<strong>列数</strong>、<strong>列标题：是</strong>、<strong>行来源类型：值列表</strong></li>
<li>设计视图下，按钮的单击事件写入以下代码</li>
</ul>
</li>
</ol>
<p><strong>另存为mdb文件</strong></p>
<p><img src="/./../img/640-1690880578433-392.png" alt="图片"></p>
<hr>
<p>目录</p>
<p>Part 3：代码</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command0_Click()  </span><br><span class="line">    <span class="comment">&#x27; 第1部分：后端操作   </span></span><br><span class="line">    <span class="comment">&#x27; 数据库连接  </span></span><br><span class="line">    <span class="keyword">Dim</span> currentDir </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line">    <span class="keyword">Dim</span> adConn As ADODB.Connection </span><br><span class="line">    <span class="keyword">Set</span> adConn = <span class="keyword">New</span> ADODB.Connection   </span><br><span class="line">    <span class="keyword">Dim</span> rs As ADODB.Recordset  </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="comment">&#x27; 数据库地址  </span></span><br><span class="line">    currentDir = Application.CurrentProject.Path &amp; <span class="string">&quot;\&quot;</span>    dbAddr = currentDir &amp; <span class="string">&quot;数据库.mdb&quot;</span>     </span><br><span class="line">    <span class="keyword">With</span> adConn    </span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0;&quot;</span>    </span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span>     </span><br><span class="line">    SQL = <span class="string">&quot;Select * From basic&quot;</span><span class="comment">&#x27;   </span></span><br><span class="line">    <span class="keyword">Set</span> rs = adConn.<span class="keyword">Execute</span>(SQL)  </span><br><span class="line">    rs.Open SQL, adConn, adOpenKeyset, adLockOptimistic  </span><br><span class="line">    <span class="comment">&#x27; 第2部分：前端显示   </span></span><br><span class="line">    <span class="keyword">Set</span> ctrl = <span class="keyword">Me</span>.Controls(<span class="string">&quot;List1&quot;</span>) </span><br><span class="line">    <span class="comment">&#x27;清除原listbox 信息  </span></span><br><span class="line">    ctrl.RowSource = <span class="string">&quot;&quot;</span>    </span><br><span class="line">    <span class="keyword">Dim</span> rsCount  </span><br><span class="line">    </span><br><span class="line">    rsCount = rs.RecordCount     </span><br><span class="line">    <span class="keyword">If</span> rsCount &lt; <span class="number">1</span> <span class="keyword">Then</span> <span class="comment">&#x27;没有信息&#x27;  </span></span><br><span class="line">        strAnswer = <span class="built_in">MsgBox</span>(<span class="string">&quot;无数据&quot;</span>, vbInformation, <span class="string">&quot;提示&quot;</span>)     </span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span>   </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>      </span><br><span class="line">    fildCount = rs.Fields.Count   <span class="comment">&#x27; 字段数目  </span></span><br><span class="line">    existsRow = ctrl.ListCount    <span class="comment">&#x27; 当前已写入行        </span></span><br><span class="line">    <span class="comment">&#x27;写入表头   </span></span><br><span class="line">    tableHeader = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">If</span> existsRow = <span class="number">0</span> <span class="keyword">Then</span>    </span><br><span class="line">        <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> fildCount - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span>    </span><br><span class="line">            fildName = rs.Fields(i).Name      </span><br><span class="line">            <span class="keyword">If</span> tableHeader = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span>         </span><br><span class="line">                tableHeader = fildName      </span><br><span class="line">            <span class="keyword">Else</span>               </span><br><span class="line">                tableHeader = tableHeader &amp; <span class="string">&quot;;&quot;</span> &amp; fildName    </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">Next</span> i</span><br><span class="line">        ctrl.AddItem tableHeader </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>     </span><br><span class="line">    <span class="comment">&#x27;回到第一条记录  </span></span><br><span class="line">    rs.MoveFirst   </span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> rsCount   </span><br><span class="line">        fildContents = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildCount - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span>    </span><br><span class="line">            fildContent = rs.Fields(j).Value   </span><br><span class="line">            <span class="keyword">If</span> fildContents = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span>        </span><br><span class="line">                fildContents = fildContent     </span><br><span class="line">            <span class="keyword">Else</span>              </span><br><span class="line">                fildContents = fildContents &amp; <span class="string">&quot;;&quot;</span> &amp; fildContent     </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">Next</span> j     </span><br><span class="line">        ctrl.AddItem fildContents</span><br><span class="line">        rs.MoveNext </span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    adConn.Close  </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span>  </span><br><span class="line">    <span class="keyword">Set</span> adConn = <span class="literal">Nothing</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>





<p><strong>代码截图</strong></p>
<p><img src="/./../img/640-1690880578433-393.png" alt="图片"></p>
<p><img src="/./../img/640-1690880578433-394.png" alt="图片"></p>
<hr>
<p>目录</p>
<p>Part 4：部分代码解读</p>
<ol>
<li><p>对数据库的操作，一般分为以下几个步骤</p>
</li>
<li><ul>
<li>确定数据库地址</li>
<li>连接数据库</li>
<li>确定SQL语句</li>
<li>执行SQL语句</li>
<li>若有返回结果，对返回结果进行处理</li>
</ul>
</li>
<li><p>执行SQL语句一般有两种方法</p>
</li>
<li><ul>
<li><code>Set rs = adConn.Execute(SQL)</code>，若无需返回结果，可以采用该方法，例如插入、删除、更新等操作</li>
<li><code>rs.Open SQL, adConn, adOpenKeyset, adLockOptimistic</code>，若需要返回结果，可以采用该方法，例如查询</li>
<li>当然还有一些更细致的区别，但一般也只用到这两个区别</li>
</ul>
</li>
<li><p>本文使用<code>ADODB.Connection</code>连接数据库，记得务必在<strong>Access</strong>中手动加入引用，本文采用的是<code>Microsoft ActiveX Data Objects 6.1 Library</code>,加入方法如下</p>
</li>
<li><ul>
<li>VBE界面下<strong>工具</strong>菜单-引用</li>
</ul>
</li>
</ol>
<p><img src="/./../img/640-1690880578433-395.png" alt="图片"></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>目录</p>
<p>Part 5：小结</p>
<ol>
<li>本文中对<em><strong>mdb</strong></em>数据库的连接方法与<em><strong>accdb</strong></em>采用一样的方法，目前来看可以适用</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 常用小实例 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-常用功能解析-01-账户权限管理]]></title>
      <url>/2023/08/01/Access-%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD%E8%A7%A3%E6%9E%90-01-%E8%B4%A6%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>根据打开软件的不同用户，赋予不同操作权限</li>
<li>本质上就是将一部分控件禁用，一部分控件启用</li>
<li>如下图所示，打开窗体时，禁用按钮<strong>非管理员按钮</strong>，启用按钮<strong>管理员按钮</strong>，在文本框中写入当前登录账户</li>
</ol>
<p>效果图</p>
<p><img src="/./../img/640-1690880364122-379.png" alt="图片"></p>
<p><strong>Part 2：实现步骤</strong></p>
<ol>
<li>画出设计图，文本框名称为<em><strong>txt1*<strong>，管理员按钮名称为</strong>*cmd1**<em>，非管理员按钮名称为</em></strong>cmd2*</em>*</li>
</ol>
<p>界面设计</p>
<p><img src="/./../img/640-1690880364123-380.png" alt="图片"></p>
<p><strong>Part 3：代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Form_Load()  </span><br><span class="line">    currentUserName = Environ(<span class="string">&quot;username&quot;</span>)  </span><br><span class="line">    Debug.Pr<span class="built_in">int</span> (currentUserName)     </span><br><span class="line">    <span class="keyword">Set</span> frm = Forms(<span class="string">&quot;窗体1&quot;</span>)    </span><br><span class="line">    <span class="keyword">Set</span> ctrl1 = frm.Controls(<span class="string">&quot;cmd1&quot;</span>)  </span><br><span class="line">    <span class="keyword">Set</span> ctrl2 = frm.Controls(<span class="string">&quot;cmd2&quot;</span>) </span><br><span class="line">    <span class="keyword">Set</span> ctrl3 = frm.Controls(<span class="string">&quot;txt1&quot;</span>)      </span><br><span class="line">    <span class="keyword">If</span> currentUserName = <span class="string">&quot;Administrator&quot;</span> <span class="keyword">Then</span>     </span><br><span class="line">        ctrl1.Enabled = <span class="literal">True</span>    </span><br><span class="line">        ctrl2.Enabled = <span class="literal">False</span> </span><br><span class="line">    <span class="keyword">Else</span>    </span><br><span class="line">        ctrl1.Enabled = <span class="literal">False</span>      </span><br><span class="line">        ctrl2.Enabled = <span class="literal">True</span>  </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>     </span><br><span class="line">    ctrl3.Value = currentUserName  </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690880364126-381.png" alt="图片"></p>
<p><strong>Part 3：部分代码解读</strong></p>
<ol>
<li><code>currentUserName = Environ(&quot;username&quot;)</code>获取当前登录账户</li>
<li><code>ctrl1.Enabled = True</code>启用控件<em><strong>ctrl1</strong></em></li>
<li><code>ctrl2.Enabled = False</code>禁用控件<em><strong>ctrl2</strong></em></li>
<li>***Private Sub Form_Load()***，窗体启动事件</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 常用小实例 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-窗体-02-进度条]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E7%AA%97%E4%BD%93-02-%E8%BF%9B%E5%BA%A6%E6%9D%A1/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：示例</strong></p>
<ol>
<li>点击按钮实现进度条显示，并显示完成程度百分比</li>
</ol>
<p>效果图<br><img src="/./../img/640-1690880136994-358.png" alt="图片"></p>
<p>动态图<br><img src="/./../img/640-1690880136994-359.gif" alt="图片"></p>
<p><strong>Part 2：代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 进度条()   </span><br><span class="line">    <span class="keyword">Dim</span> i, n  </span><br><span class="line">    n = <span class="number">5000</span>   </span><br><span class="line">    UserForm1.Show <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">Set</span> ProgressBar1 = UserForm1.ProgressBar1</span><br><span class="line">    ProgressBar1.Max = n  </span><br><span class="line">    ProgressBar1.Min = <span class="number">0</span>     </span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> n  </span><br><span class="line">        process = <span class="built_in">CInt</span>(<span class="number">100</span> * (i - <span class="number">0</span>) / (n - <span class="number">0</span>))    </span><br><span class="line">        UserForm1.Caption = <span class="string">&quot;完成度：&quot;</span> &amp; process &amp; <span class="string">&quot;%&quot;</span>   </span><br><span class="line">        ProgressBar1.Value = i  </span><br><span class="line">    <span class="keyword">Next</span>  </span><br><span class="line">    Unload UserForm1  </span><br><span class="line">    MsgBox <span class="string">&quot;完成&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690880136994-360.png" alt="图片"></p>
<p><strong>Part 3：窗体搭建</strong></p>
<p>新建一个窗体，插入控件<code>ProgressBar</code></p>
<ol>
<li><ul>
<li>如果没有发现控件工具箱，可以在菜单栏：<strong>视图</strong>-<strong>工具箱</strong>打开</li>
</ul>
</li>
<li><ul>
<li>默认是没有进度条控件的，需要人工加入，鼠标悬浮在工具箱<strong>控件区域</strong>位置上，右键<code>附加控件</code>，注意鼠标位置，不同位置右键效果不同。添加控件<code>Microsoft ProgressBar Control</code></li>
</ul>
</li>
</ol>
<p>显示工箱</p>
<p><img src="/./../img/640-1690880136994-361.png" alt="图片"></p>
<p>添加进度条控件</p>
<p><img src="/./../img/640-1690880136994-362.png" alt="图片"></p>
<p><img src="/./../img/640-1690880136994-363.png" alt="图片"></p>
<p><strong>Part 4：部分代码解读</strong></p>
<ol>
<li><code>UserForm1.Show 0</code>，显示窗体</li>
<li><code>Unload UserForm1</code>，关闭窗体</li>
<li><code>Set ProgressBar1 = UserForm1.ProgressBar1</code>，定义控件</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 弹出控件 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-窗体-01-弹出]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E7%AA%97%E4%BD%93-01-%E5%BC%B9%E5%87%BA/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍窗体。涉及功能为：点击按钮后，弹出一个窗体</li>
<li>严格来说窗体不是控件，它是控件的载体</li>
</ol>
<p>效果动图</p>
<p><img src="/./../img/640-1690879931180-340.gif" alt="图片"></p>
<p><strong>Part 2：实现步骤</strong></p>
<ol>
<li><p>本项目中涉及到两个窗体</p>
</li>
<li><ul>
<li>窗体<em><strong>main</strong></em>作为主窗体，有一个按钮，点击后弹出窗体<strong>弹窗</strong></li>
<li>窗体<strong>弹窗</strong>，需要将其<strong>弹出方式</strong>选择<strong>是</strong></li>
</ul>
</li>
<li><p>窗体<em><strong>main</strong></em>中设置按钮对应的代码</p>
</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command0_Click() </span><br><span class="line">    <span class="keyword">Dim</span> frm   </span><br><span class="line">    <span class="keyword">Dim</span> ctrl </span><br><span class="line">    <span class="keyword">Dim</span> frmName   </span><br><span class="line">    frmName = <span class="string">&quot;弹窗&quot;</span>    </span><br><span class="line">    DoCmd.OpenForm (frmName)     </span><br><span class="line">    <span class="keyword">Set</span> frm = Forms(frmName)  </span><br><span class="line">    frm.Caption = <span class="string">&quot;说明&quot;</span>      </span><br><span class="line">    <span class="keyword">Set</span> ctrl = frm.Controls(<span class="string">&quot;Label4&quot;</span>) </span><br><span class="line">    strSay = <span class="string">&quot;这是一个测试弹窗功能的小程序&quot;</span>  </span><br><span class="line">    ctrl.Caption = strSay</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>代码截图<br><img src="/./../img/640-1690879931180-341.png" alt="图片"></p>
<p>窗体<strong>弹窗</strong></p>
<p><img src="/./../img/640-1690879931180-342.png" alt="图片"></p>
<p><strong>弹出方式</strong>设置</p>
<p><img src="/./../img/640-1690879931180-343.png" alt="图片"></p>
<p><strong>Part 3：部分代码解读</strong></p>
<ol>
<li><code>DoCmd.OpenForm (frmName)</code>打开窗体</li>
<li><code>frm.Caption = &quot;说明&quot;</code>设置标题</li>
</ol>
<p>设置标题效果</p>
<p><img src="/./../img/640-1690879931180-344.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 弹出空间 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-按钮-02-来个双击]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E6%8C%89%E9%92%AE-02-%E6%9D%A5%E4%B8%AA%E5%8F%8C%E5%87%BB/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：<strong>按钮</strong>。涉及功能为：双击事件</li>
</ol>
<p>效果动图</p>
<p><img src="/./../img/640-1690879828265-328.gif" alt="图片"></p>
<p><strong>Part 2：实现步骤</strong></p>
<ol>
<li>设计视图下，插入按钮</li>
<li>选中按钮，右键-属性，事件选项卡下，双击，关联事件过程</li>
<li>点击右侧的<code>...</code>，直接打开<em><strong>VBE</strong></em>界面，进行代码编写</li>
<li>直接关联的代码是在窗体对应的代码窗口，建议核心代码还是写在模块下，方便管理，窗体代码只是一个事件导入</li>
<li>仔细看下图，发现有很多事件，不仅仅只是最近写的两篇文章，单击事件，双击事件，其它事件大家可以试试</li>
<li>对于其它控件，也有一些事件，但是每个控件支持的事件可能是不同的</li>
</ol>
<p>属性设置</p>
<p><img src="/./../img/640-1690879828265-329.png" alt="图片"></p>
<p><strong>标签</strong>支持事件</p>
<p><img src="/./../img/640-1690879828265-330.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 按钮 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-按钮-01-关联代码]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E6%8C%89%E9%92%AE-01-%E5%85%B3%E8%81%94%E4%BB%A3%E7%A0%81/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：<strong>按钮</strong>。涉及功能为：关联代码</li>
</ol>
<p>效果动图</p>
<p><img src="/./../img/640-1690879757230-313.gif" alt="图片"></p>
<p><strong>Part 2：实现步骤</strong></p>
<ol>
<li>设计视图下，插入按钮</li>
<li>选中按钮，右键-属性，事件选项卡下，单击，关联事件过程</li>
<li>点击右侧的<code>...</code>，直接打开<em><strong>VBE</strong></em>界面，进行代码编写</li>
<li>直接关联的代码是在窗体对应的代码窗口，建议核心代码还是写在模块下，方便管理，窗体代码只是一个事件导入</li>
</ol>
<p>插入按钮</p>
<p><img src="/./../img/640-1690879757230-314.png" alt="图片"></p>
<p>属性设置</p>
<p><img src="/./../img/640-1690879757230-315.png" alt="图片"></p>
<p>代码位置</p>
<p><img src="/./../img/640-1690879757230-316.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 按钮 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-文本框-01-格式设置]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E6%96%87%E6%9C%AC%E6%A1%86-01-%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：<strong>文本框</strong>。涉及功能为：文本框输入内容的<strong>格式</strong>限制</li>
<li>一般系统可以简单理解为有3个部分组成：<strong>输入</strong>-<strong>处理</strong>-<strong>输出</strong></li>
<li>对于输入这部分往往会有些要求，例如要求输入日期。因为使用客户不同，如果希望由客户来主动规范化输入是不现实的，所以希望系统方面来限制</li>
</ol>
<p>功能效果<br><img src="/./../img/640-1690879638307-298.png" alt="图片"></p>
<p><strong>Part 2：实现步骤</strong></p>
<ol>
<li><strong>设计视图</strong>下，插入文本框</li>
<li>选中文本框，右键-属性，格式选项卡下，选择需求的格式</li>
<li>设置完格式后，当用户输入不满足要求的数据时，系统会提示</li>
</ol>
<p>插入文本框</p>
<p><img src="/./../img/640-1690879638308-299.png" alt="图片"></p>
<p>格式选项卡</p>
<p><img src="/./../img/640-1690879638309-300.png" alt="图片"></p>
<p>输入格式错误</p>
<p><img src="/./../img/640-1690879638310-301.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 文本框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-组合框-02-两个组合框联动]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E7%BB%84%E5%90%88%E6%A1%86-02-%E4%B8%A4%E4%B8%AA%E7%BB%84%E5%90%88%E6%A1%86%E8%81%94%E5%8A%A8/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：组合框。涉及功能为：两个组合框联动</li>
</ol>
<p><strong>功能动图</strong></p>
<p><img src="/./../img/640-1690879336337-283.gif" alt="图片"></p>
<p><strong>Part 2：实现功能</strong></p>
<ol>
<li>手动设置<strong>省</strong>组合框下拉列表：广东，湖南</li>
<li><strong>省</strong>组合框变化时，<strong>市</strong>组合框下拉列表随之变化</li>
<li>这里<strong>省</strong>组合框有3个事件，都引起<strong>市</strong>组合框下拉列表变化，包括<strong>更改</strong>，<strong>键按下</strong>，<strong>进入</strong>三个事件。具体哪些事件会触发，根据需要自己制定。一般来说这三种即可</li>
</ol>
<p>界面</p>
<p><img src="/./../img/640-1690879336337-284.png" alt="图片"></p>
<p>3类事件</p>
<p><img src="/./../img/640-1690879336338-285.jpeg" alt="图片"></p>
<p><strong>Part 3：代码</strong></p>
<p><strong>事件代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> cbo1_Change()  </span><br><span class="line">    frmName = <span class="keyword">Me</span>.Name</span><br><span class="line">    <span class="keyword">Call</span> sMod_通用库_01_零件名称下拉列表(frmName)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> cbo1_Enter()  </span><br><span class="line">    frmName = <span class="keyword">Me</span>.Name</span><br><span class="line">    <span class="keyword">Call</span> sMod_通用库_01_零件名称下拉列表(frmName)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> cbo1_KeyDown(KeyCode As Integer, Shift As Integer)  </span><br><span class="line">    frmName = <span class="keyword">Me</span>.Name</span><br><span class="line">    <span class="keyword">Call</span> sMod_通用库_01_零件名称下拉列表(frmName)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>实际动作</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> sMod_通用库_01_零件名称下拉列表(frmName)    </span><br><span class="line">    <span class="keyword">Dim</span> ctrl    </span><br><span class="line">    <span class="keyword">Dim</span> frm   </span><br><span class="line">    <span class="keyword">Dim</span> ctrlName        </span><br><span class="line">    <span class="keyword">Set</span> frm = Forms(frmName)        </span><br><span class="line">    <span class="keyword">Set</span> ctrl = frm.Controls(<span class="string">&quot;cbo1&quot;</span>)  </span><br><span class="line">    sheng = ctrl.Value       </span><br><span class="line">    ctrlName = <span class="string">&quot;cbo2&quot;</span>   </span><br><span class="line">    <span class="keyword">Set</span> cbo = frm.Controls(ctrlName)      </span><br><span class="line">    <span class="keyword">If</span> sheng = <span class="string">&quot;广东&quot;</span> <span class="keyword">Then</span>        </span><br><span class="line">        cbo.RowSource = <span class="string">&quot;&quot;</span>        </span><br><span class="line">        cbo.Value = <span class="string">&quot;&quot;</span>               </span><br><span class="line">        arr = <span class="built_in">Array</span>(<span class="string">&quot;广州&quot;</span>, <span class="string">&quot;深圳&quot;</span>, <span class="string">&quot;东莞&quot;</span>, <span class="string">&quot;佛山&quot;</span>)       </span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> x <span class="keyword">In</span> arr           </span><br><span class="line">            cbo.AddItem x       </span><br><span class="line">        <span class="keyword">Next</span>    </span><br><span class="line">    <span class="keyword">ElseIf</span> sheng = <span class="string">&quot;湖南&quot;</span> <span class="keyword">Then</span>       </span><br><span class="line">        cbo.RowSource = <span class="string">&quot;&quot;</span>       </span><br><span class="line">        cbo.Value = <span class="string">&quot;&quot;</span>               </span><br><span class="line">        arr = <span class="built_in">Array</span>(<span class="string">&quot;长沙&quot;</span>, <span class="string">&quot;湘潭&quot;</span>, <span class="string">&quot;株洲&quot;</span>, <span class="string">&quot;郴州&quot;</span>)       </span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> x <span class="keyword">In</span> arr           </span><br><span class="line">            cbo.AddItem x       </span><br><span class="line">        <span class="keyword">Next</span>   </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>   </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图****代码位置</strong>：将通用代码写在模块内了，方便代码复用</p>
<p><img src="/./../img/640-1690879336338-286.png" alt="图片"></p>
<p><strong>Part 4：部分代码解读</strong></p>
<ol>
<li>虽然本示例中涉及3个事件，但只是触发不一样，但引起的结果是一样的，所以将共用代码写在了模块内</li>
<li><code>frmName = Me.Name</code>，获取当前窗体名称，该代码必须放在对应的窗体中才有效</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 组合框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-组合框-01-下拉列表]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E7%BB%84%E5%90%88%E6%A1%86-01-%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：<strong>组合框</strong>。涉及功能为：下拉列表的实现</li>
</ol>
<p>功能动图</p>
<p><img src="/./../img/640-1690879216174-271.gif" alt="图片"></p>
<p><strong>Part 2：实现功能</strong></p>
<ol>
<li>手动设置组合框下拉列表：长江；黄河；珠江；淮河</li>
<li>通过代码修改组合框下拉列表：1；2；3；4</li>
<li><strong>应用场景</strong>，组合框的下拉列表随着另外一个控件的取值变化而变化。例如，两个组合框，一个显示省份，一个显示城市，当省份不同时，城市组合框下拉列表也会不同</li>
</ol>
<p><strong>手动设置</strong>：打开组合框<strong>属性</strong> - <strong>数据</strong>选项卡 - <strong>行来源类型</strong>设置为<strong>值列表</strong> - <strong>行来源</strong>设置下拉列表数据，以<strong>分号</strong>**;**隔开</p>
<p><img src="/./../img/640-1690879216174-272.png" alt="图片"></p>
<p><strong>Part 3：代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command4_Click() </span><br><span class="line">    ctrlName = <span class="string">&quot;Combo2&quot;</span>   </span><br><span class="line">    <span class="keyword">Set</span> cbo = <span class="keyword">Me</span>.Controls(ctrlName) </span><br><span class="line">    cbo.RowSource = <span class="string">&quot;&quot;</span> </span><br><span class="line">    cbo.Value = <span class="string">&quot;&quot;</span></span><br><span class="line">    arr = <span class="built_in">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)  </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> x <span class="keyword">In</span> arr   </span><br><span class="line">        cbo.AddItem x   </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690879216175-273.png" alt="图片"></p>
<p><strong>Part 4：部分代码解读</strong></p>
<p><img src="/./../img/640-1690879216174-270.png" alt="图片"></p>
<ol>
<li><code>cbo.RowSource = &quot;&quot;</code>，将下拉列表清空</li>
<li><code>cbo.Value = &quot;&quot;</code>，将组合框取值清空</li>
<li><code>cbo.AddItem x</code> ，增加组合框下拉列表</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 组合框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-列表框-04-双击效果]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%88%97%E8%A1%A8%E6%A1%86-04-%E5%8F%8C%E5%87%BB%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<p><strong>Part 1：本篇目标</strong></p>
<ol>
<li>本篇介绍的控件为：<strong>列表框</strong>。涉及功能为：双击列表框显示所选行第1列信息</li>
</ol>
<p>功能动图</p>
<p><img src="/./../img/640-1690879009674-259.gif" alt="图片"></p>
<p><strong>Part 2：代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span></span><br><span class="line">    List0_DblClick(Cancel As Integer)</span><br><span class="line">    ctrlName = <span class="string">&quot;List0&quot;</span>  </span><br><span class="line">    <span class="keyword">Set</span> ctrl = <span class="keyword">Me</span>.Controls(ctrlName)  </span><br><span class="line">    chooseRow = ctrl.ListIndex <span class="comment">&#x27;listIndex 计数不包括标题行   </span></span><br><span class="line">    colNum = <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">If</span> chooseRow &gt;= <span class="number">0</span> <span class="keyword">Then</span>    </span><br><span class="line">        chooseContent = ctrl.Column(colNum - <span class="number">1</span>, chooseRow + <span class="number">1</span>)    </span><br><span class="line">        MsgBox <span class="string">&quot;选中行第1列信息为：&quot;</span> &amp; chooseContent  </span><br><span class="line">    <span class="keyword">Else</span>     </span><br><span class="line">        chooseContent = <span class="string">&quot;未选中&quot;</span>    </span><br><span class="line">        MsgBox chooseContent        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>  </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690879009674-260.jpeg" alt="图片"></p>
<p><strong>Part 3：事件设置</strong></p>
<ol>
<li>获取选项内容在上一篇文章中已经讲过，核心函数<code>ctrl.Column</code></li>
<li>设置双击事件：<strong>设计视图</strong>下-右键列表框-选择<strong>属性</strong>-选择<strong>事件</strong>选项卡-设置<strong>双击</strong>事件</li>
<li>对应双击事件<em>Sub</em>名称：<code>List0_DblClick(Cancel As Integer)</code>，***DblClick，double click***的缩写</li>
<li>整个<em><strong>Sub</strong></em>名称是系统自动生成的，尽量不要自己看出规律后人为建立，有时候系统无法识别</li>
</ol>
<p>事件设置</p>
<p><img src="/./../img/640-1690879009675-261.jpeg" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 列表框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-列表框-03-向列表框录入信息]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%88%97%E8%A1%A8%E6%A1%86-03-%E5%90%91%E5%88%97%E8%A1%A8%E6%A1%86%E5%BD%95%E5%85%A5%E4%BF%A1%E6%81%AF/</url>
      <content type="html"><![CDATA[<p>目录</p>
<p>Part 1：本篇目标</p>
<ol>
<li>本篇介绍的控件为：<strong>列表框</strong>。涉及功能为：向列表框中录入信息</li>
</ol>
<p>功能动图</p>
<p><img src="/./../img/640-1690878870332-240.gif" alt="图片"></p>
<p>静图</p>
<p><img src="/./../img/640-1690878870332-241.png" alt="图片"></p>
<p>目录</p>
<p>Part 2：代码</p>
<p>录入信息</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> btn_Click()</span><br><span class="line">    arrTitle = <span class="built_in">Array</span>(<span class="string">&quot;姓名&quot;</span>, <span class="string">&quot;性别&quot;</span>, <span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">    arrContents1 = <span class="built_in">Array</span>(<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;男&quot;</span>, <span class="number">20</span>)</span><br><span class="line">    arrContents2 = <span class="built_in">Array</span>(<span class="string">&quot;李四&quot;</span>, <span class="string">&quot;男&quot;</span>)</span><br><span class="line">    arrContents3 = <span class="built_in">Array</span>(<span class="number">100</span>)        </span><br><span class="line">    <span class="keyword">Set</span> ctrl = <span class="keyword">Me</span>.Controls(<span class="string">&quot;List0&quot;</span>)</span><br><span class="line">    ctrl.RowSource = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;加入标题</span></span><br><span class="line">    inputContents = arrToStr(arrTitle)</span><br><span class="line">    ctrl.AddItem inputContents    <span class="comment">&#x27;加入内容</span></span><br><span class="line">    inputContents = arrToStr(arrContents1)</span><br><span class="line">    ctrl.AddItem inputContents</span><br><span class="line"></span><br><span class="line">    inputContents = arrToStr(arrContents2)</span><br><span class="line">    ctrl.AddItem inputContents</span><br><span class="line"></span><br><span class="line">    inputContents = arrToStr(arrContents3)</span><br><span class="line">    ctrl.AddItem inputContentsEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690878870332-242.jpeg" alt="图片"></p>
<p><strong>数组转为字符串</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> arrToStr(arr)        <span class="comment">&#x27;假设数组不为空</span></span><br><span class="line">    op = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">UBound</span>(arr) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        op = arr(<span class="number">0</span>)       </span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> x <span class="keyword">In</span> arr                        </span><br><span class="line">            <span class="keyword">If</span> op = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                op = x &amp; <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">                op = op &amp; <span class="string">&quot;;&quot;</span> &amp; x                       </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    arrToStr = opEnd <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>



<p>代码截图</p>
<p><img src="/./../img/640-1690878870332-243.png" alt="图片"></p>
<p>清空列表框</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> btn2_Click()        </span><br><span class="line">    <span class="keyword">Set</span> ctrl = <span class="keyword">Me</span>.Controls(<span class="string">&quot;List0&quot;</span>)</span><br><span class="line">    ctrl.RowSource = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>代码截图</p>
<p><img src="/./../img/640-1690878870332-244.png" alt="图片"></p>
<p>目录</p>
<p>Part 3：部分代码解读</p>
<ol>
<li><code>ctrl.AddItem inputContents</code>，向列表框一行一行加入信息，要求输入内容为<strong>字符串</strong>，不同列之间用**;**分开</li>
<li><code>op = x &amp; &quot;&quot;</code>，将其它数据类型转为字符串，其实在本示例可以不使用，会自动转为字符串，可以手动测试一下</li>
</ol>
<p>ListBox.AddItem官方解读</p>
<p><img src="/./../img/640-1690878870332-245.jpeg" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 列表框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-列表框-02-获取选项]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%88%97%E8%A1%A8%E6%A1%86-02-%E8%8E%B7%E5%8F%96%E9%80%89%E9%A1%B9/</url>
      <content type="html"><![CDATA[<p>Part 1：本篇目标</p>
<ol>
<li>本篇介绍的控件为：列表框。涉及功能为：后台获取用户的选择项</li>
<li>UI界面存在大量与用户互动的部分，根据客户不同的选择展现不同的信息</li>
</ol>
<p><strong>功能动图</strong></p>
<p><img src="/./../img/640-1690874789826-228.gif" alt="图片"></p>
<p><strong>静图</strong></p>
<p><img src="/./../img/640-1690874789826-229.png" alt="图片"></p>
<p>Part 2：代码</p>
<p><strong>控件关联代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> 获取姓名信息_Click()</span><br><span class="line">    frmName = <span class="keyword">Me</span>.Name</span><br><span class="line">    ctrlName = <span class="string">&quot;List0&quot;</span></span><br><span class="line">    colNum = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    x = 获取列表框选项(frmName, ctrlName, colNum)</span><br><span class="line">    MsgBox <span class="string">&quot;选择姓名为：&quot;</span> &amp; x</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>





<p><strong>核心函数</strong>：获取不同列，改变***colNum***值即可</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> 获取列表框选项(frmName, ctrlName, colNum)        <span class="keyword">Rem</span>&gt;&gt;</span><br><span class="line">    <span class="keyword">Dim</span> frm        </span><br><span class="line">    <span class="keyword">Dim</span> ctrl        </span><br><span class="line">    <span class="keyword">Dim</span> chooseRow        </span><br><span class="line">    <span class="keyword">Set</span> frm = Forms(frmName)        </span><br><span class="line">    <span class="keyword">Set</span> ctrl = frm.Controls(ctrlName)</span><br><span class="line">    chooseRow = ctrl.ListIndex <span class="comment">&#x27;listIndex 计数不包括标题行</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;ListBox.Column(Index, Row)，Index表示列信息，Row表示行信息，都是从0开始</span></span><br><span class="line">    <span class="keyword">If</span> chooseRow &gt;= <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        获取列表框选项 = ctrl.Column(colNum - <span class="number">1</span>, chooseRow + <span class="number">1</span>)        </span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        获取列表框选项 = <span class="string">&quot;未选中&quot;</span></span><br><span class="line">    <span class="keyword">End</span> IfEnd <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>





<p><strong>代码截图</strong></p>
<p><img src="/./../img/640-1690874789826-230.jpeg" alt="图片"></p>
<p>Part 3：部分代码解读</p>
<ol>
<li><p><code>chooseRow = ctrl.ListIndex</code>，注意是否设置列标题选项，在计数时，是不包括列标题的</p>
</li>
<li><p><code>ListBox.Column(Index, Row)</code>，列表框可以看成一个<strong>Excel</strong>表格，不同的是</p>
</li>
<li><ul>
<li>行和列都是从0开始计数</li>
<li>与Excel中不同的是，先是列再是行，格式：（列，行）</li>
</ul>
</li>
</ol>
<p><strong>ListBox.Column官方解读</strong></p>
<p><img src="/./../img/640-1690874825992-237.jpeg" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 列表框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-控件解析-列表框-01-多选数目获取]]></title>
      <url>/2023/08/01/Access-%E6%8E%A7%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%88%97%E8%A1%A8%E6%A1%86-01-%E5%A4%9A%E9%80%89%E6%95%B0%E7%9B%AE%E8%8E%B7%E5%8F%96/</url>
      <content type="html"><![CDATA[<p>Part 1：本篇目标</p>
<ol>
<li><p>本篇介绍的控件为：<strong>列表框</strong></p>
</li>
<li><ul>
<li>列表框可以理解成一个简单的***Excel***表格，只不过不能直接编辑</li>
<li>可以将第一行设置为列标题</li>
</ul>
</li>
<li><p>列表框支持多选（属性表-其他-多重选择-展开的），本文目标在于：每次选择后获取选择的行数</p>
</li>
<li><ul>
<li>关于多重选择，有两种：简单；展开的</li>
<li>简单：左键直接多选</li>
<li>展开的：<em><strong>windows</strong></em>多选方法（结合<em><strong>ctrl</strong></em>和<em><strong>shift</strong></em>）</li>
</ul>
</li>
</ol>
<p><strong>功能动图</strong></p>
<p><img src="/./../img/640-1690874638367-201.gif" alt="图片"></p>
<p><strong>展示给客户的最终界面如下</strong></p>
<p><img src="/./../img/640-1690874638367-202.png" alt="图片"></p>
<p><strong>列表框控件位置</strong></p>
<p><img src="/./../img/640-1690874638367-203.jpeg" alt="图片"></p>
<p><strong>列表框录入数据</strong></p>
<p><img src="/./../img/640-1690874638368-204.png" alt="图片"></p>
<p><strong>打开多重选择功能</strong></p>
<p><img src="/./../img/640-1690874638368-205.png" alt="图片"></p>
<p><strong>打开列标题功能</strong></p>
<p><img src="/./../img/640-1690874638368-206.png" alt="图片"></p>
<p>Part 2：代码</p>
<p><strong>窗体内代码</strong></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> 选择数目_Click()        </span><br><span class="line">    <span class="keyword">Set</span> ctrl = <span class="keyword">Me</span>.Controls(<span class="string">&quot;List0&quot;</span>)</span><br><span class="line">    choose_num = ctrl.ItemsSelected.Count</span><br><span class="line">    MsgBox <span class="string">&quot;选中数目：&quot;</span> &amp; choose_num</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>





<p><strong>代码截图</strong></p>
<p><img src="/./../img/640-1690874638369-207.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
            <tag> 控件 </tag>
            
            <tag> 列表框 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-15-表信息整体迁移]]></title>
      <url>/2023/08/01/Access-VBA-Excel-15-%E8%A1%A8%E4%BF%A1%E6%81%AF%E6%95%B4%E4%BD%93%E8%BF%81%E7%A7%BB/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：问题"><a href="#Part-1：问题" class="headerlink" title="Part 1：问题"></a>Part 1：问题</h2><ol>
<li>有一个<strong>原信息</strong>表存储着学生的姓名和成绩信息，现在需要对信息进行扩容</li>
<li>有一个<strong>新信息</strong>表，不仅有学生的姓名和成绩信息，还有一些其它信息</li>
<li>问题：将<strong>原信息</strong>表中满足要求的信息复制到<strong>新信息</strong>表中去，示例复制张三的信息</li>
</ol>
<p><strong>原信息</strong>数据表<br><img src="/./../img/640-1690874446329-180.png" alt="图片"></p>
<p><strong>新信息</strong>表<br><img src="/./../img/640-1690874446329-181.png" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> adConn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\信息档案.accdb&quot;</span></span><br><span class="line">    tbl1Name = <span class="string">&quot;原信息&quot;</span></span><br><span class="line">    tbl2Name = <span class="string">&quot;新信息&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> adConn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    opFilds = <span class="string">&quot;*&quot;</span></span><br><span class="line">    searchC = <span class="string">&quot;姓名=&#x27;张三&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Insert Into &quot;</span> &amp; tbl2Name &amp; <span class="string">&quot; Select &quot;</span> &amp; opFilds &amp; <span class="string">&quot; From &quot;</span> &amp; tbl1Name &amp; <span class="string">&quot; Where (&quot;</span> &amp; searchC &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> rs = adConn.<span class="keyword">Execute</span>(SQL)<span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/640-1690874446329-182.jpeg" alt="图片"></p>
<p><strong>执行结果</strong><br><img src="/./../img/640-1690874446329-183.png" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li>**核心*SQL***：<code>Insert Into 新信息 Select * From 原信息 Where (姓名=&#39;张三&#39;)</code></li>
<li>上面<em><strong>SQL</strong></em>由两部分组成：<em><strong>Insert Into</strong></em> 加入新表部分，<em><strong>Select</strong></em> 查询获取拟加入新表的信息</li>
<li>这种方法要求<strong>新信息</strong>表中必须有相同的字段</li>
</ol>
<p><strong>核心*SQL*</strong><br><img src="/./../img/640-1690874446329-184.png" alt="图片"></p>
<h2 id="Part-4：延伸"><a href="#Part-4：延伸" class="headerlink" title="Part 4：延伸"></a>Part 4：延伸</h2><ul>
<li>只从<strong>旧信息</strong>表中获取2个字段：姓名，语文</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Insert Into 新信息 Select 姓名,语文 From 原信息 Where (姓名=&#x27;李四&#x27;)</span><br></pre></td></tr></table></figure>

<p><strong>执行结果</strong><br><img src="/./../img/640-1690874446330-185.png" alt="图片"></p>
<ul>
<li><p>从<strong>旧信息</strong>表中获取所有字段所有记录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Insert Into 新信息 Select * From 原信息</span><br></pre></td></tr></table></figure>

<p><strong>执行结果</strong><br><img src="/./../img/640-1690874446330-186.png" alt="图片"></p>
</li>
</ul>
<p><strong>思考</strong>：下面这句***SQL***的结果又是什么效果呢？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">Into</span> 新信息 (姓名,数学) <span class="keyword">Select</span> 姓名,语文 <span class="keyword">From</span> 原信息 <span class="keyword">Where</span> (姓名<span class="operator">=</span><span class="string">&#x27;李四&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-14-消除重复值]]></title>
      <url>/2023/08/01/Access-VBA-Excel-14-%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E5%80%BC/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：题目"><a href="#Part-1：题目" class="headerlink" title="Part 1：题目"></a>Part 1：题目</h2><ol>
<li>从地址表中获取含有的省份信息，结果是：广东省，湖南省，安徽省</li>
<li>那么怎么使用<em><strong>SQL</strong></em>实现呢</li>
</ol>
<p><strong>地址</strong>数据表<br><img src="/./../img/640-1690874333335-168.png" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\地址信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;地址&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    opFilds = <span class="string">&quot;省份&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select distinct &quot;</span> &amp; opFilds &amp; <span class="string">&quot; from &quot;</span> &amp; tblName </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)            </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line">    sht.Cells.ClearContents</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/640-1690874333336-169.jpeg" alt="图片"></p>
<p><strong>执行结果</strong><br><img src="/./../img/640-1690874333336-170.png" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><p>**核心*SQL***：<code>Select distinct 省份 from 地址</code></p>
</li>
<li><p>中文释义：</p>
</li>
<li><ul>
<li>从<strong>地址</strong>中获取<strong>省份</strong>字段非重复的值</li>
<li>关键字：<em><strong>distinct</strong></em>，在字段前加上这个关键字，输出值中就没有重复值</li>
</ul>
</li>
</ol>
<p><strong>核心SQL</strong><br><img src="/./../img/640-1690874333336-171.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-13-嵌套查询]]></title>
      <url>/2023/08/01/Access-VBA-Excel-13-%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：题目"><a href="#Part-1：题目" class="headerlink" title="Part 1：题目"></a>Part 1：题目</h2><ol>
<li>获取<strong>张三</strong>，<strong>李四</strong>的数学成绩</li>
<li>已知条件：数据库中有两个表（<strong>学生信息表</strong>，<strong>成绩表</strong>），如下图</li>
<li>逻辑过程：从<strong>学生信息表</strong>中获取张三&#x2F;李四的学号，从<strong>成绩表</strong>中以<strong>学号</strong>查询满足条件的<strong>数学成绩</strong></li>
</ol>
<p><strong>学生信息表</strong><br><img src="/./../img/0-1690874160819-153.jpeg" alt="图片"></p>
<p><strong>成绩表</strong><br><img src="/./../img/0-1690874160820-154.jpeg" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tbl1Name = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line">    tbl2Name = <span class="string">&quot;成绩表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    op1Filds = <span class="string">&quot;学号&quot;</span></span><br><span class="line">    search1C = <span class="string">&quot;姓名 in (&#x27;张三&#x27;,&#x27;李四&#x27;)&quot;</span></span><br><span class="line">    SQL1 = <span class="string">&quot;Select &quot;</span> &amp; op1Filds &amp; <span class="string">&quot; from &quot;</span> &amp; tbl1Name &amp; <span class="string">&quot; where (&quot;</span> &amp; search1C &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line">    op2Filds = <span class="string">&quot;学号,年级,数学成绩&quot;</span></span><br><span class="line">    search2C = <span class="string">&quot;学号 in (&quot;</span> &amp; SQL1 &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line">    SQL2 = <span class="string">&quot;Select &quot;</span> &amp; op2Filds &amp; <span class="string">&quot; from &quot;</span> &amp; tbl2Name &amp; <span class="string">&quot; where (&quot;</span> &amp; search2C &amp; <span class="string">&quot;) order by 学号 asc,年级 desc&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL2)            </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line">    sht.Cells.ClearContents</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/0-1690874160820-155.jpeg" alt="图片"></p>
<p><strong>执行结果</strong><br><img src="/./../img/0-1690874160820-156.jpeg" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><p>**核心*SQL***：<code>Select 学号,年级,数学成绩 from 成绩表 where (学号 in (Select 学号 from 学生信息表 where (姓名 in (&#39;张三&#39;,&#39;李四&#39;)))) order by 学号 asc,年级 desc</code></p>
</li>
<li><p><strong>中文释义</strong>：</p>
</li>
<li><ul>
<li>两层***Select***，内层获取张三&#x2F;李四的学号，外层以学号检索需要的信息</li>
<li>输出排序：第一级排序以<strong>学号</strong>升序（<em><strong>asc</strong></em>），第二级排序以<strong>年级</strong>降序（<em><strong>desc</strong></em>）</li>
</ul>
</li>
</ol>
<p><strong>核心SQL</strong><br><img src="/./../img/0-1690874160820-157.jpeg" alt="图片"></p>
<p><strong>思考</strong>：输出的信息中不含有姓名信息，看起来不清晰，那么如何将姓名信息加进来呢？和之前的<strong>left join</strong>结合吗？</p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-12-模糊查询]]></title>
      <url>/2023/08/01/Access-VBA-Excel-12-%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><strong>商品清单</strong><br><img src="/./../img/640-1690874077454-129.png" alt="图片"></p>
<ol>
<li><p>根据<strong>商品ID</strong>检索需要的商品</p>
</li>
<li><p>通过模糊检索实现，有点<strong>百度</strong>的味道，只知道部分信息，来查询</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定***SQL***语句</li>
<li>执行<strong><em>SQL*<strong>语句，得到</strong></em>recordset</strong>*</li>
<li>将***recordset***写入工作表（字段名+所有记录 <strong>即</strong> 列名+每一行）</li>
<li>断开与数据库的连接</li>
</ul>
</li>
<li><p>检索<strong>商品ID</strong>首字母为<em><strong>m</strong></em>的商品</p>
</li>
</ol>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\商品清单.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;商品清单&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    opFilds = <span class="string">&quot;商品ID,商品名称,厂家,数量&quot;</span></span><br><span class="line">    searchC = <span class="string">&quot;商品ID like &#x27;m%&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select &quot;</span> &amp; opFilds &amp; <span class="string">&quot; from &quot;</span> &amp; tblName &amp; <span class="string">&quot; where (&quot;</span> &amp; searchC &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)            </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line">    sht.Cells.ClearContents</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/640-1690874077454-130.jpeg" alt="图片"></p>
<p><strong>执行结果</strong><br><img src="/./../img/640-1690874077454-131.png" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><code>Select 商品ID,商品名称,厂家,数量 from 商品清单 where (商品ID like &#39;m%&#39;)</code></li>
<li><strong>中文释义</strong>：选取满足<strong>商品ID</strong>第1位为字母*<strong>m*<strong>的商品信息，从结果看，</strong>没有区分</strong>大小写</li>
<li>这样的***%<em><strong>表示</strong>0</em>*或者<strong>任意字符</strong>，有点像<code>*</code>的作用</li>
</ol>
<p><strong>Part 4：延伸</strong></p>
<hr>
<ul>
<li><code>_</code>代表单一字符，<code>searchC = &quot;商品ID like &#39;____&#39;&quot;</code>，<strong>四个下划线</strong>，结果如下</li>
</ul>
<p><img src="/./../img/640-1690874077455-132.png" alt="图片"></p>
<ul>
<li><code>[]</code>指定范围，<code>searchC = &quot;商品ID like &#39;[0-9]%&#39;&quot;</code>，表示***0-9***开头的字符串，结果如下</li>
</ul>
<p><img src="/./../img/640-1690874077455-133.png" alt="图片"></p>
<ul>
<li><code>[ ]</code>指定范围，<code>searchC = &quot;商品ID like &#39;[a-z]%&#39;&quot;</code>，表示<em>a-z</em>开头的字符串，依然没有区分大小写，结果如下</li>
</ul>
<p><img src="/./../img/640-1690874077455-134.png" alt="图片"></p>
<ul>
<li><p><code>[!]</code>指定范围之外，<code>searchC = &quot;商品ID like &#39;[!a-z]%&#39;&quot;</code>，表示不以***a-z***开头，结果如下</p>
<p><img src="/./../img/640-1690874077455-135.png" alt="图片"></p>
</li>
<li><p><code>not like</code>取反，<code>searchC = &quot;商品ID not like &#39;[a-z]%&#39;&quot;</code>，表示<strong>不满足a-z</strong>开头的字符串，依然<strong>没有区分</strong>大小写，结果如下</p>
</li>
</ul>
<p><img src="/./../img/640-1690874077455-136.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-左连接-11]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E5%B7%A6%E8%BF%9E%E6%8E%A5-11/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><strong>成绩表</strong></p>
<p><img src="/./../img/640-1690873974530-102.png" alt="图片"></p>
<p><strong>学生信息表</strong></p>
<p><img src="/./../img/640-1690873974530-103.png" alt="图片"></p>
<p><strong>运行过程</strong></p>
<p><img src="/./../img/0-1690873974530-104.gif" alt="图片"></p>
<ol>
<li><p>获取学号为<em><strong>1101</strong></em>学生在不同年级的<strong>语文成绩</strong>，输出信息包括：<strong>姓名，学号，性别，年级，语文成绩</strong></p>
</li>
<li><p>最终想要获得的信息来自于两个工作表，所以需要连接查询</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定<em><strong>SQL</strong></em>语句</li>
<li>执行<em><strong>SQL</strong></em>语句，得到*<strong>recordset*</strong></li>
<li>将<em><strong>recordset</strong></em>写入工作表（字段名+所有记录 <strong>即</strong> 列名+每一行）</li>
<li>断开与数据库的连接</li>
</ul>
</li>
<li><p><em><strong>SQL</strong></em>语句</p>
</li>
<li><ul>
<li><code>&quot;Select &quot; &amp; opFilds &amp; &quot; from &quot; &amp; &quot;(&quot; &amp; tbls &amp; &quot;)&quot; &amp; &quot; where (&quot; &amp; searchC &amp; &quot;)&quot;</code></li>
<li><code>opFilds = &quot;姓名,&quot; &amp; tblNote &amp; &quot;.学号,性别,年级,语文成绩&quot;</code></li>
<li><code>searchC = tblNote &amp; &quot;.学号=1101&quot;</code></li>
<li><code>tbls = tblNote &amp; &quot; left join &quot; &amp; tblName &amp; &quot; on &quot; &amp; tblNote &amp; &quot;.学号=&quot; &amp; tblName &amp; &quot;.学号&quot;</code></li>
</ul>
</li>
</ol>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line">    tblNote = <span class="string">&quot;成绩表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    opFilds = <span class="string">&quot;姓名,&quot;</span> &amp; tblNote &amp; <span class="string">&quot;.学号,性别,年级,语文成绩&quot;</span></span><br><span class="line">    searchC = tblNote &amp; <span class="string">&quot;.学号=1101&quot;</span></span><br><span class="line"></span><br><span class="line">    tbls = tblNote &amp; <span class="string">&quot; left join &quot;</span> &amp; tblName _</span><br><span class="line">    &amp; <span class="string">&quot; on &quot;</span> &amp; tblNote &amp; <span class="string">&quot;.学号=&quot;</span> &amp; tblName &amp; <span class="string">&quot;.学号&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select &quot;</span> &amp; opFilds &amp; <span class="string">&quot; from &quot;</span> &amp; <span class="string">&quot;(&quot;</span> &amp; tbls &amp; <span class="string">&quot;)&quot;</span> &amp; <span class="string">&quot; where (&quot;</span> &amp; searchC &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)        </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    sht.Cells.ClearContents</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName       </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong></p>
<p><img src="/./../img/640-1690873974530-105.jpeg" alt="图片"></p>
<p><img src="/./../img/640-1690873974531-106.jpeg" alt="图片"></p>
<p><strong>执行结果</strong></p>
<p><img src="/./../img/640-1690873974531-107.png" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><p><code>SQL = &quot;Select &quot; &amp; opFilds &amp; &quot; from &quot; &amp; &quot;(&quot; &amp; tbls &amp; &quot;)&quot; &amp; &quot; where (&quot; &amp; searchC &amp; &quot;)&quot;</code></p>
</li>
<li><ul>
<li>本问题中，相关变量取值后<em><strong>SQL</strong></em>语句如下</li>
<li>*<strong>Select*</strong> 姓名,成绩表.学号,性别,年级,语文成绩 *<strong>from*</strong> (成绩表 *<strong>left join*</strong> 学生信息表 *<strong>on*</strong> 成绩表.学号&#x3D;学生信息表.学号) *<strong>where*</strong> (成绩表.学号&#x3D;1101)</li>
</ul>
</li>
<li><pre><code>Select 姓名,成绩表.学号,性别,年级,语文成绩 from (成绩表 left join 学生信息表 on 成绩表.学号=学生信息表.学号) where (成绩表.学号=1101)
</code></pre>
</li>
<li><p><strong>中文解读</strong>：从成绩表和学生信息表连接表中获取学号为1101的学生信息</p>
</li>
<li><p><code>表1 left join 表2 on 表1.ID=表2.ID</code></p>
</li>
<li><ul>
<li>两个表进行连接，以左侧为基准，即这里的<strong>表1</strong></li>
<li>连接条件：表1与表2的ID号相同</li>
<li>当表2中满足表1中ID条件的有多条记录，那么进行分别匹配</li>
<li>当表2中没有满足表1中ID的条件时，匹配Null</li>
</ul>
</li>
</ol>
<p><strong>例1</strong>：匹配多个，修改<strong>学生信息表</strong>，增加同样学号的</p>
<p><img src="/./../img/640-1690873974531-108.png" alt="图片"></p>
<p><strong>查询结果</strong></p>
<p><img src="/./../img/640-1690873974531-109.png" alt="图片"></p>
<p><strong>例2</strong>：若未匹配上，则对应信息为空</p>
<p><img src="/./../img/640-1690873974532-110.png" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel - access - vba </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-多条件筛选数据-10]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E5%A4%9A%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE-10/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><img src="/./../img/640-1690873872930-90.png" alt="图片"></p>
<ol>
<li><p>目标1：将数据库中数据表<strong>学生信息表</strong>中的语文成绩大于<strong>85分</strong>且学号<strong>大于</strong>4的人员信息读入当前工作簿<strong>示例</strong>工作表</p>
</li>
<li><p>目标2：将数据库中数据表<strong>学生信息表</strong>中姓名为<strong>张三</strong>或者<strong>小红</strong>的人员信息读入当前工作簿<strong>示例</strong>工作表</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定SQL语句</li>
<li>执行SQL语句，得到<em>recordset</em></li>
<li>将<em><strong>recordset</strong></em>写入工作表（字段名+所有记录 <strong>即</strong> 列名+每一行）</li>
<li>断开与数据库的连接</li>
</ul>
</li>
<li><p>实现两个目标只有<em><strong>SQL</strong></em>语句不同，其余一致</p>
</li>
<li><ul>
<li>目标1：<code>SQL = &quot;Select * from &quot; &amp; tblName &amp; &quot; where 语文成绩&gt;85 and 学号&gt;4&quot;</code></li>
<li>目标2：<code>SQL = &quot;Select * from &quot; &amp; tblName &amp; &quot; where 姓名 in(&#39;张三&#39;,&#39;小红&#39;)&quot;</code></li>
</ul>
</li>
</ol>
<p><strong>目标1</strong><br><img src="/./../img/640-1690873872930-91.png" alt="图片"></p>
<p><strong>目标2</strong><br><img src="/./../img/640-1690873872930-92.png" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select * from &quot;</span> &amp; tblName &amp; <span class="string">&quot; where 语文成绩&gt;85 and 学号&gt;4&quot;</span><span class="comment">&#x27;   SQL = &quot;Select * from &quot; &amp; tblName &amp; &quot; where 姓名 in(&#x27;张三&#x27;,&#x27;小红&#x27;)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)        </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line">    sht.Cells.ClearContents</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/640-1690873872931-93.jpeg" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><p><code>SQL = &quot;Select * from &quot; &amp; tblName &amp; &quot; where 语文成绩&gt;85 and 学号&gt;4&quot;</code>，中文释义：从工作表中获取满足语文成绩&gt;85且学号&gt;4的所有信息</p>
</li>
<li><p><code>SQL = &quot;Select * from &quot; &amp; tblName &amp; &quot; where 姓名 in(&#39;张三&#39;,&#39;小红&#39;)&quot;</code>，中文释义：从工作表中获取满足姓名为张三或者小红的所有信息，也可以使用<code>or</code>来实现该功能</p>
</li>
<li><ul>
<li><code>&quot;Select * from &quot; &amp; tblName &amp; &quot; where 姓名=&#39;张三&#39; or 姓名=&#39;小红&#39;&quot;</code></li>
</ul>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-单表筛选数据-09]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E5%8D%95%E8%A1%A8%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE-09/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><img src="https://mmbiz.qpic.cn/mmbiz_png/OSQ4UFyzdeN92ZOSmM847ib3iadwibRoQTwozs3Amy6UfkK8HzM1rv85iagajyaofDkY1FVeaqibsEibribcILucCkZvg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ol>
<li><p>将数据库中数据表<strong>学生信息表</strong>中的语文成绩<strong>大于85分</strong>的人员信息读入当前工作簿<strong>示例</strong>工作表</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定<em><strong>SQ</strong>L</em>语句</li>
<li>执行<strong><em>SQL*<strong>语句，得到</strong></em>recordset</strong>*</li>
<li>将<em><strong>recordset</strong></em>写入工作表（字段名+所有记录 <strong>即</strong> 列名+每一行）</li>
<li>断开与数据库的连接</li>
</ul>
</li>
<li><p>所以与上一篇文章的区别在于<em><strong>SQL</strong></em>语句</p>
</li>
</ol>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select * from &quot;</span> &amp; tblName &amp; <span class="string">&quot; where 语文成绩&gt;85&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)            </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/OSQ4UFyzdeN92ZOSmM847ib3iadwibRoQTwbJb0micJricK8MSoicSnKh7icZKu7Xwibt14jyqKgUnmBH8SmaVJ4VePxkg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>Access与Excel数据对比</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/OSQ4UFyzdeN92ZOSmM847ib3iadwibRoQTwWeoMTxdRU7MnIcicjmNTUnT96RicRcnGicnHsyAnB3DvhbLXzPiahcnUzQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><p><code>&quot;Select * from &quot; &amp; tblName &amp; &quot; where 语文成绩&gt;85&quot;</code>，中文释义：从工作表中获取满足语文成绩&gt;85所有信息</p>
</li>
<li><p><code>rs.Fields.Count</code>获取字段数目</p>
</li>
<li><ul>
<li>字段是从0开始计数，所以最后一个字段表示为rs.Fields(rs.Fields.Count-1)</li>
</ul>
</li>
<li><p><code>rs.Fields(j).Name</code>获取字段的名称（列名）</p>
</li>
<li><p><code>CopyFromRecordset</code>复制整个<code>rs</code>（所有记录）</p>
</li>
</ol>
<p><strong>联想</strong>：那么是不是还有其它筛选方式呢？那必须有，这也是<em><strong>SQL</strong></em>的强大之处，常规<em><strong>VBA</strong></em>语句需要写很多代码实现的功能，<em><strong>SQL</strong></em>一句可能就搞定了</p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-获取数据库数据-08]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE-08/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><img src="/./../img/640-1690873608593-70.jpeg" alt="图片"></p>
<ol>
<li><p>将<em><strong>Access*<strong>数据库中数据表</strong>学生信息表</strong>中的所有信息读入当前</em><strong>Excel*<strong>工作簿</strong>示例</strong>工作表</p>
</li>
<li><p>***VBA***逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定SQL语句</li>
<li>执行SQL语句，得到<em><strong>recordset</strong></em></li>
<li>将<em><strong>recordset</strong></em>写入工作表（字段名+所有记录 <strong>即</strong> 列名+每一行）</li>
<li>断开与数据库的连接</li>
</ul>
</li>
</ol>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset       </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select * from &quot;</span> &amp; tblName        </span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)        </span><br><span class="line">    <span class="keyword">Dim</span> sht        </span><br><span class="line">    <span class="keyword">Dim</span> fildNum        </span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(<span class="string">&quot;示例&quot;</span>)</span><br><span class="line"></span><br><span class="line">    fildNum = rs.Fields.Count        </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> fildNum - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        fildName = rs.Fields(j).Name</span><br><span class="line">        sht.Cells(<span class="number">1</span>, j + <span class="number">1</span>) = fildName        </span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line"></span><br><span class="line">    sht.Cells(<span class="number">2</span>, <span class="number">1</span>).CopyFromRecordset rs</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong></p>
<p><img src="/./../img/640-1690873608593-71.jpeg" alt="图片"></p>
<p>**运行过程<br>**</p>
<p><img src="/./../img/0.gif" alt="图片"></p>
<p><strong>Access与Excel数据对比</strong></p>
<p><img src="/./../img/640-1690873608593-72.jpeg" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><code>Select * from &quot; &amp; tblName</code>，中文释义：从工作表中获取所有信息</li>
<li><code>rs.Fields.Count</code>获取字段数目</li>
<li><code>rs.Fields(j).Name</code>获取字段的名称（列名）</li>
<li><code>CopyFromRecordset</code>复制整个<code>rs</code>（所有记录）</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-Access字段删除-07]]></title>
      <url>/2023/08/01/Access-VBA-Excel-Access%E5%AD%97%E6%AE%B5%E5%88%A0%E9%99%A4-07/</url>
      <content type="html"><![CDATA[<blockquote>
<ul>
<li>这个系列开展一个新的篇章，重点关注Access数据库</li>
<li>主体框架：以Excel作为操作界面，Access作为数据库</li>
<li>今天讲讲如何删除特定字段</li>
<li>涉及知识：<code>ADO</code>，<code>SQL：Alter + drop</code></li>
</ul>
</blockquote>
<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><p><img src="/./../img/640-1690872346770-61.png" alt="图片"></p>
<ol>
<li><p>如上图所示，删除<strong>性别</strong>这一<strong>字段</strong>（列）</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定***SQL***语句</li>
<li>执行<em><strong>SQL</strong></em>语句</li>
<li>断开与数据库的连接</li>
</ul>
</li>
</ol>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        </span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        </span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        </span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Alter table &quot;</span> &amp; tblName &amp; <span class="string">&quot; drop Column 性别&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    cnn.Close        </span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>**代码截图<br>**</p>
<p><img src="/./../img/640-1690872346771-62.jpeg" alt="图片"></p>
<p><strong>执行后效果</strong></p>
<p><img src="/./../img/640-1690872346771-63.png" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><code>Alter table &quot; &amp; tblName &amp; &quot; drop Column 性别</code></li>
<li>中文释义：改变工作表，具体变化点为删除<strong>性别</strong>列（<strong>字段</strong>）</li>
<li>删除不同表下不同的字段，只需替换<strong>表名称</strong>及<strong>字段名称</strong>即可</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-Access记录删除-06]]></title>
      <url>/2023/08/01/Access-VBA-Excel-Access%E8%AE%B0%E5%BD%95%E5%88%A0%E9%99%A4-06/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><ol>
<li><p>删除姓名为<strong>张三</strong>的这一条记录</p>
</li>
<li><p>逻辑过程</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>根据需求确定***SQL***语句</li>
<li>执行***SQL***语句</li>
<li>断开与数据库的连接</li>
</ul>
</li>
</ol>
<p><strong>删除记录前</strong></p>
<p><img src="/./../img/640-1690872280975-55.jpeg" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()        <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset        <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName        <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;delete from &quot;</span> &amp; tblName &amp; <span class="string">&quot; where 姓名=&#x27;张三&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    cnn.Close        <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>执行后效果</strong></p>
<p><img src="/./../img/640-1690872280976-56.jpeg" alt="图片"></p>
<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><code>delete from &quot; &amp; tblName &amp; &quot; where 姓名=&#39;张三&#39;</code></li>
<li>中文释义：从工作表中删除一条 <strong>姓名</strong>字段取值为<strong>张三</strong>的一条记录</li>
<li>注意：张三有<strong>单引号</strong>包围起来</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-Access记录修改-05]]></title>
      <url>/2023/08/01/Access-VBA-Excel-Access%E8%AE%B0%E5%BD%95%E4%BF%AE%E6%94%B9-05/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><ol>
<li><p>前文中，我们已经获取了一个工作表（学生信息表）和4个字段（ID，姓名，学号，性别），并输入了两行记录</p>
</li>
<li><p>今天在原有字段的基础上增加<strong>籍贯</strong>，<strong>语文成绩</strong>两个新的字段</p>
</li>
<li><p>并对原<strong>张三</strong>的记录做一些修改：修改学号信息，增加籍贯及语文成绩信息</p>
</li>
<li><ul>
<li>原记录：张三，11，男</li>
<li>修改后：张三，<strong>1</strong>，男，<strong>广东省</strong>，<strong>85</strong></li>
</ul>
</li>
</ol>
<p><strong>结果如下</strong></p>
<p><img src="/./../img/640-1690872173015-52.jpeg" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()</span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset</span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName</span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    field1 = <span class="string">&quot;籍贯 text(10)&quot;</span></span><br><span class="line">    field2 = <span class="string">&quot;语文成绩 single&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;增加字段</span></span><br><span class="line">    SQL = <span class="string">&quot;ALTER TABLE &quot;</span> &amp; tblName &amp; <span class="string">&quot; ADD &quot;</span> &amp; field1 &amp; <span class="string">&quot;,&quot;</span> &amp; field2</span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;补充记录</span></span><br><span class="line">    stuName = <span class="string">&quot;张三&quot;</span></span><br><span class="line">    jiGuan = <span class="string">&quot;广东省&quot;</span></span><br><span class="line">    yuWenNote = <span class="number">85</span></span><br><span class="line">    newXueHao = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Update &quot;</span> &amp; tblName &amp; <span class="string">&quot; SET &quot;</span> _</span><br><span class="line">    &amp; <span class="string">&quot;籍贯=&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; jiGuan &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) _</span><br><span class="line">    &amp; <span class="string">&quot;,语文成绩=&quot;</span> &amp; yuWenNote _</span><br><span class="line">    &amp; <span class="string">&quot;,学号=&quot;</span> &amp; newXueHao _</span><br><span class="line">    &amp; <span class="string">&quot; where 姓名=&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; stuName &amp; <span class="built_in">Chr</span>(<span class="number">39</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    cnn.Close</span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Part-3：部分代码解读"><a href="#Part-3：部分代码解读" class="headerlink" title="Part 3：部分代码解读"></a>Part 3：部分代码解读</h2><ol>
<li><code>Update 工作表名 set 字段1=X1，字段2=X2 where 字段4=X4</code></li>
<li>中文释义：修改（更新）工作表，字段4&#x3D;X4所在记录（行）中，字段1的值改为&#x3D;X1，字段2改为X2</li>
<li>即：通过某一字段的值，定位到某一记录（行），修改这一记录（行）中其它字段的值</li>
</ol>
<p><strong>小结：</strong>对数据库的操作转化为对应的<code>SQL</code>语句，然后运行，搞定</p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-Access记录创建-04]]></title>
      <url>/2023/08/01/Access-VBA-Excel-Access%E8%AE%B0%E5%BD%95%E5%88%9B%E5%BB%BA-04/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：目标"><a href="#Part-1：目标" class="headerlink" title="Part 1：目标"></a>Part 1：目标</h2><ol>
<li><p>从上一篇文章中，我们已经获取了一个工作表（<strong>学生信息表</strong>）和4个字段（<strong>ID</strong>，<strong>姓名</strong>，<strong>学号</strong>，<strong>性别</strong>）</p>
</li>
<li><p>今天的文章开始向Access数据库中录入一条条数据</p>
</li>
<li><p>包括两条记录</p>
</li>
<li><ul>
<li>张三，11，男</li>
<li>李四，12，男</li>
</ul>
</li>
</ol>
<p><strong>结果如下</strong></p>
<p><img src="/./../img/640-1690872060121-49.jpeg" alt="图片"></p>
<h2 id="Part-2：代码"><a href="#Part-2：代码" class="headerlink" title="Part 2：代码"></a>Part 2：代码</h2><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()</span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection</span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset</span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName</span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;记录1</span></span><br><span class="line">    stuName = <span class="string">&quot;张三&quot;</span></span><br><span class="line">    stuNum = <span class="number">11</span></span><br><span class="line">    stuGender = <span class="string">&quot;男&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;INSERT INTO &quot;</span> &amp; tblName &amp; <span class="string">&quot; (姓名,学号,性别) VALUES&quot;</span> _</span><br><span class="line">    &amp; <span class="string">&quot;(&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; stuName &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; <span class="string">&quot;,&quot;</span> &amp; stuNum &amp; <span class="string">&quot;,&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; stuGender &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;记录2</span></span><br><span class="line">    stuName = <span class="string">&quot;李四&quot;</span></span><br><span class="line">    stuNum = <span class="number">12</span></span><br><span class="line">    stuGender = <span class="string">&quot;男&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;INSERT INTO &quot;</span> &amp; tblName &amp; <span class="string">&quot; (姓名,学号,性别) VALUES&quot;</span> _</span><br><span class="line">    &amp; <span class="string">&quot;(&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; stuName &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; <span class="string">&quot;,&quot;</span> &amp; stuNum &amp; <span class="string">&quot;,&quot;</span> &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; stuGender &amp; <span class="built_in">Chr</span>(<span class="number">39</span>) &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line">    cnn.Close</span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Part-3：部分代码解读s"><a href="#Part-3：部分代码解读s" class="headerlink" title="Part 3：部分代码解读s"></a>Part 3：部分代码解读s</h2><ol>
<li><code>INSERT INTO 工作表名称 （字段1，字段2，字段3） VALUES（字段1对应值，字段2对应值，字段3对应值）</code></li>
<li>中文释义：向工作表X中的字段1中录入数据X，字段2中录入数据X，字段3录入数据X</li>
<li>若字段中对应值为字符串，需在单引号（**Chr(39)**）中<code>&#39;&#39;</code>，若是时间，则使用<code>#时间信息#</code></li>
<li><code>ID</code>字段是自增式，无需额外赋值，每有一个新的记录，会自动+1</li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Excel-Excel-入门（Excel作为界面端，Excel作为数据库）]]></title>
      <url>/2023/08/01/Excel-Excel-%E5%85%A5%E9%97%A8%EF%BC%88Excel%E4%BD%9C%E4%B8%BA%E7%95%8C%E9%9D%A2%E7%AB%AF%EF%BC%8CExcel%E4%BD%9C%E4%B8%BA%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89/</url>
      <content type="html"><![CDATA[<p><strong>示例</strong>：<strong><em>Excel*<strong>作为数据库，从</strong></em>Excel</strong><em>中获取来自于<strong>交通院</strong>，语文和数学成绩都是*</em>&gt;80**分的信息</p>
<p><img src="/./../img/640-1690871561199-13.png" alt="图片"></p>
<p><strong>实现结果</strong><br><img src="/./../img/640-1690871561200-14.png" alt="图片"></p>
<h2 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h2><ol>
<li><p>传统方法：对数据表进行循环判断，找到满足条件的行</p>
</li>
<li><p>新方法：查询通过一句***SQL***实现<code>SQL = &quot;Select &quot; &amp; filds &amp; &quot; From &quot; &amp; tbl_name &amp; &quot; Where (&quot; &amp; searchC &amp; &quot;)&quot;</code>，逻辑过程如下：</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>确定***SQL***语句</li>
<li>执行***SQL***语句</li>
<li>获取结果</li>
<li>断开数据库</li>
</ul>
</li>
</ol>
<p><strong>SQL</strong><br><img src="/./../img/640-1690871561201-15.png" alt="图片"></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><strong>过程</strong><code>main</code></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> main()        <span class="keyword">Dim</span> dbAddr</span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\数据源.xlsx&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> adConn As ADODB.Connection  <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Set</span> adConn = <span class="keyword">New</span> ADODB.Connection        <span class="keyword">Dim</span> rs As ADODB.Recordset        <span class="keyword">Set</span> rs = <span class="keyword">New</span> ADODB.Recordset            <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> filds        <span class="keyword">Dim</span> tbl_name        <span class="keyword">Dim</span> searchC</span><br><span class="line"></span><br><span class="line">    adConn.Open <span class="string">&quot;provider=Microsoft.ACE.OLEDB.12.0;&quot;</span> _</span><br><span class="line">                            &amp; <span class="string">&quot;extended properties=excel 12.0;&quot;</span> _</span><br><span class="line">                            &amp; <span class="string">&quot;data source=&quot;</span> &amp; dbAddr</span><br><span class="line"></span><br><span class="line">    filds = <span class="string">&quot;姓名,学院,语文,数学&quot;</span></span><br><span class="line">    tbl_name = <span class="string">&quot;[data$]&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> searchC1        <span class="keyword">Dim</span> searchC2        <span class="keyword">Dim</span> searchC3        <span class="keyword">Dim</span> sht_name        <span class="keyword">Dim</span> sht        <span class="keyword">Dim</span> i</span><br><span class="line"></span><br><span class="line">    searchC1 = <span class="string">&quot;学院=&#x27;交通院&#x27;&quot;</span></span><br><span class="line">    searchC2 = <span class="string">&quot;语文&gt;80&quot;</span></span><br><span class="line">    searchC3 = <span class="string">&quot;数学&gt;80&quot;</span></span><br><span class="line">    searchC = searchC1 &amp; <span class="string">&quot; and &quot;</span> &amp; searchC2 &amp; <span class="string">&quot; and &quot;</span> &amp; searchC3</span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;Select &quot;</span> &amp; filds &amp; <span class="string">&quot; From &quot;</span> &amp; tbl_name &amp; <span class="string">&quot; Where (&quot;</span> &amp; searchC &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> rs = adConn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    sht_name = <span class="string">&quot;示例&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> sht = ThisWorkbook.Worksheets(sht_name)            <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> rs.Fields.Count <span class="keyword">Step</span> <span class="number">1</span></span><br><span class="line">        sht.Range(<span class="string">&quot;A1&quot;</span>).Offset(<span class="number">0</span>, i - <span class="number">1</span>) = rs.Fields(i - <span class="number">1</span>).Name <span class="comment">&#x27;字段序号从0开始</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"></span><br><span class="line">    sht.Range(<span class="string">&quot;A2&quot;</span>).CopyFromRecordset rs</span><br><span class="line">    sht.Cells.EntireColumn.AutoFit        <span class="comment">&#x27;关闭数据库</span></span><br><span class="line">    adConn.Close        <span class="keyword">Set</span> adConn = NothingEnd <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>代码截图</strong><br><img src="/./../img/640-1690871561201-16.jpeg" alt="图片"></p>
<h2 id="部分代码解读"><a href="#部分代码解读" class="headerlink" title="部分代码解读"></a>部分代码解读</h2><ol>
<li><p>数据库连接<br>***Excel***<strong>连接</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adConn.Open &quot;provider=Microsoft.ACE.OLEDB.12.0;&quot; _</span><br><span class="line">             &amp; &quot;extended properties=excel 12.0;&quot; _</span><br><span class="line">             &amp; &quot;data source=&quot; &amp; dbAddr</span><br></pre></td></tr></table></figure>

<p><strong>Access连接</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">With adConn</span><br><span class="line">     .Provider = &quot;Microsoft.ACE.OLEDB.12.0;&quot;</span><br><span class="line">     .Open &quot;Data Source=&quot; &amp; dbAddrEnd With</span><br></pre></td></tr></table></figure>
</li>
<li><p>工作表的表示方法<code>tbl_name = &quot;[data$]&quot;</code>，使用<code>[$]</code></p>
</li>
<li><p>复制***rs***信息到工作表：<code>sht.Range(&quot;A2&quot;).CopyFromRecordset rs</code></p>
</li>
</ol>
<p>**<br>**</p>
<p><strong>Ps</strong>：<br>1）采用<em><strong>ADO</strong></em>的方式连接的数据库，需要人为先在*<strong>VBE*<strong>中打开这个引用，菜单</strong>工具</strong>-<strong>引用</strong><br><img src="/./../img/640-1690871561202-17.png" alt="图片"><br>2)当数据量越大，本文中采用的方式，效率越明显，是不错的方法幺</p>
]]></content>
      
        <categories>
            
            <category> excel </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> 数据库 </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-Access表及字段创建-03]]></title>
      <url>/2023/08/01/Access-VBA-Excel-Access%E8%A1%A8%E5%8F%8A%E5%AD%97%E6%AE%B5%E5%88%9B%E5%BB%BA-03/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：前面的话"><a href="#Part-1：前面的话" class="headerlink" title="Part 1：前面的话"></a>Part 1：前面的话</h2><ol>
<li>对Access数据库的大部分操作都可以通过<code>SQL</code>语言来实现</li>
<li><code>SQL:Structure Query Language</code>，结构化查询语言，语法简单，非常容易学</li>
<li><code>SQL</code>语言的执行可借助于<code>ADO</code>，<code>ADO</code>本身也支持对数据库的各种操作，但是涉及到一些其它知识的学习</li>
<li>这个系列中，除非无法用<code>SQL</code>来实现，否则会使用<code>SQL</code></li>
<li><code>SQL</code>作为数据库操作的通用语言，学会了后也可用于对其它数据库的操作，那也是极好的</li>
</ol>
<h2 id="Part-2：本篇目标"><a href="#Part-2：本篇目标" class="headerlink" title="Part 2：本篇目标"></a>Part 2：本篇目标</h2><ol>
<li><p>对已有空白数据库创建一个<strong>数据表</strong></p>
</li>
<li><p>根据要求创建新的字段，指定字段的约束</p>
</li>
<li><p>基本逻辑过程：</p>
</li>
<li><ul>
<li>连接数据库</li>
<li>确定<code>SQL</code>语句</li>
<li>执行<code>SQL</code>语句</li>
<li>根据需求重复上面两步</li>
<li>关闭数据库的连接</li>
</ul>
</li>
<li><p>记得引用<code>Microsoft ActiveX Data Objects 2.8 Library</code></p>
</li>
</ol>
<p><strong>Part 3：代码</strong></p>
<hr>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()</span><br><span class="line">    <span class="keyword">Dim</span> cnn As <span class="keyword">New</span> ADODB.Connection <span class="comment">&#x27;连接</span></span><br><span class="line">    <span class="keyword">Dim</span> rs As <span class="keyword">New</span> ADODB.Recordset</span><br><span class="line">    <span class="keyword">Dim</span> SQL As String</span><br><span class="line">    <span class="keyword">Dim</span> tblName</span><br><span class="line">    <span class="keyword">Dim</span> dbAddr</span><br><span class="line"></span><br><span class="line">    dbAddr = ThisWorkbook.Path &amp; <span class="string">&quot;\学生信息.accdb&quot;</span></span><br><span class="line">    tblName = <span class="string">&quot;学生信息表&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;连接数据库</span></span><br><span class="line">    <span class="keyword">With</span> cnn</span><br><span class="line">        .Provider = <span class="string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span></span><br><span class="line">        .Open <span class="string">&quot;Data Source=&quot;</span> &amp; dbAddr</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;CREATE TABLE &quot;</span> &amp; tblName &amp; <span class="string">&quot; (ID AUTOINCREMENT primary key)&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    field1 = <span class="string">&quot;姓名  text(6)&quot;</span></span><br><span class="line">    field2 = <span class="string">&quot;学号  single&quot;</span></span><br><span class="line">    field3 = <span class="string">&quot;性别  text(1)&quot;</span></span><br><span class="line"></span><br><span class="line">    SQL = <span class="string">&quot;ALTER TABLE &quot;</span> &amp; tblName &amp; <span class="string">&quot; ADD &quot;</span> &amp; field1 &amp; <span class="string">&quot;,&quot;</span> &amp; field2 &amp; <span class="string">&quot;,&quot;</span> &amp; field3</span><br><span class="line">    <span class="keyword">Set</span> rs = cnn.<span class="keyword">Execute</span>(SQL)</span><br><span class="line"></span><br><span class="line">    cnn.Close</span><br><span class="line">    <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> cnn = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p><strong>执行结果：新建表</strong></p>
<p><img src="/./../img/640-1690871939017-40.jpeg" alt="图片"></p>
<p><strong>执行结果：新建字段</strong></p>
<p><img src="/./../img/640-1690871939017-41.jpeg" alt="图片"></p>
<h2 id="Part-4：部分代码解读"><a href="#Part-4：部分代码解读" class="headerlink" title="Part 4：部分代码解读"></a>Part 4：部分代码解读</h2><ol>
<li><p><code>ADO</code>连接不同数据库采用不同引擎</p>
</li>
<li><ul>
<li><code>Microsoft.ACE.OLEDB.12.0 **连接Access**</code></li>
<li>老版本的Access（.mdb后缀的）可以使用引擎 <code>Microsoft.Jet.OLEDB.4.0</code></li>
</ul>
</li>
<li><p><code>CREATE TABLE &quot; &amp; tblName &amp; &quot; (ID AUTOINCREMENT primary key)</code>创建了一个工作表，并设置一个字段（主键，唯一且自增）</p>
</li>
<li><ul>
<li><code>CREATE TABLE 工作表名称 （字段信息）</code>，中文释义可以理解为：新建数据表XX，字段XX且为主键</li>
<li><code>ID</code>这个字段每增加一行记录，会自增1，设为主键</li>
</ul>
</li>
<li><p><code>SQL = &quot;ALTER TABLE &quot; &amp; tblName &amp; &quot; ADD &quot; &amp; field1 &amp; &quot;,&quot; &amp; field2 &amp; &quot;,&quot; &amp; field3</code>，新增字段</p>
</li>
<li><ul>
<li><code>ALTER</code>，修改，上面的<strong>SQL</strong>中文释义可以理解为，修改数据表XX增加字段XX，其实还是比较直白的</li>
</ul>
</li>
<li><p><code>field2 = &quot;学号  single&quot;</code>，设置字段特性，字段名称为<strong>学号</strong>，类型为Single，单精度实数</p>
</li>
<li><p><code>Set rs = cnn.Execute(SQL)</code>，运行该<code>SQL</code>语句</p>
</li>
</ol>
<p><strong>字段约束</strong></p>
<p><img src="/./../img/640-1690871939018-42.jpeg" alt="图片"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">主键官方定义：</span><br><span class="line"></span><br><span class="line">主键是表中的一个字段或字段集，为每条记录提供一个唯一的标识符。</span><br><span class="line">在数据库中，请将信息划分到基于主题的不同表中。</span><br><span class="line">然后，使用表关系和主键以指示 Access 如何将信息再次组合起来。</span><br><span class="line">Access 使用主键字段将多个表中的数据迅速关联起来，并以一种有意义的方式将这些数据组合在一起。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-新建Access文件-02]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E6%96%B0%E5%BB%BAAccess%E6%96%87%E4%BB%B6-02/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：逻辑过程"><a href="#Part-1：逻辑过程" class="headerlink" title="Part 1：逻辑过程"></a>Part 1：逻辑过程</h2><ol>
<li><p>引用<code>Microsoft DAO 3.6 Object Library</code>（工具-引用）</p>
</li>
<li><p>定义<code>DAO</code>及地址变量</p>
</li>
<li><p>变量赋值</p>
</li>
<li><p>判断拟创建文件是否存在，不存在则创建（带密码和不带密码的）</p>
</li>
<li><p>应用场景</p>
</li>
<li><ul>
<li>Access文件的创建，当然可以通过右键创建</li>
<li>当存在大量的Access数据库时，根据实际需要自动创建</li>
<li>或者是快速创建特定需求的数据库（如带密码）</li>
</ul>
</li>
</ol>
<h2 id="Part-2：代码（创建空白数据库）"><a href="#Part-2：代码（创建空白数据库）" class="headerlink" title="Part 2：代码（创建空白数据库）"></a>Part 2：代码（创建空白数据库）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Sub 新建Access()</span><br><span class="line">    Dim dbAccess As DAO.Database</span><br><span class="line">    Dim dbAddr1</span><br><span class="line"></span><br><span class="line">    dbAddr1 = ThisWorkbook.Path &amp; &quot;\Access数据库.accdb&quot;</span><br><span class="line">    </span><br><span class="line">    &#x27;创建数据库</span><br><span class="line">    If Dir(dbAddr1) = &quot;&quot; Then</span><br><span class="line">        Set dbAccess = CreateDatabase(dbAddr1, dbLangChineseSimplified) </span><br><span class="line">        dbAccess.Close</span><br><span class="line">    End If</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h2 id="Part-3：代码（创建带密码数据库）"><a href="#Part-3：代码（创建带密码数据库）" class="headerlink" title="Part 3：代码（创建带密码数据库）"></a>Part 3：代码（创建带密码数据库）</h2><ol>
<li>将创建数据库代码替换如下，新建Access数据库密码为<code>xxx</code></li>
<li>其中<code>pwd</code>可以理解为<code>password</code>简写</li>
<li>手动打开该数据库时，会弹出输入密码框</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set dbAccess = CreateDatabase(dbAddr2, dbLangChineseSimplified &amp; &quot;;pwd=xxx&quot;) </span><br></pre></td></tr></table></figure>

<p><strong>输入密码界面</strong></p>
<p><img src="/./../img/640-1690871843572-37.jpeg" alt="图片"></p>
<h2 id="Part-4：部分代码解读"><a href="#Part-4：部分代码解读" class="headerlink" title="Part 4：部分代码解读"></a>Part 4：部分代码解读</h2><ol>
<li><p><code>Dir(dbAddr1) = &quot;&quot;</code>判断文件是否存在，若成立表示不存在</p>
</li>
<li><p><code>CreateDatabase(数据库绝对地址,字符串比较规则)</code>，这里采用的是简体中文</p>
</li>
<li><ul>
<li>官方解读网址：<code>https://msdn.microsoft.com/en-us/library/office/ff835033.aspx</code></li>
<li><code>dbLangChineseSimplified</code>意义，官方定义：<strong>A string expression that specifies a collating order for creating the database</strong></li>
</ul>
</li>
<li><p>“;pwd&#x3D;xxx”，表示密码为xxx，注意那个<code>;</code>不能省略</p>
</li>
</ol>
<p><strong>番外：</strong>其实也可以通过在硬盘中设置一个空白的Access文件，若需新建文件，直接复制该文件即可</p>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access/VBA/Excel-数据库-01]]></title>
      <url>/2023/08/01/Access-VBA-Excel-%E6%95%B0%E6%8D%AE%E5%BA%93-01/</url>
      <content type="html"><![CDATA[<h2 id="Part-1：概览"><a href="#Part-1：概览" class="headerlink" title="Part 1：概览"></a>Part 1：概览</h2><ol>
<li><p>在我们之前介绍种种<code>VBA</code>的使用，其实主要就是一个<strong>数据处理过程</strong>，类比我们的工作很多时候人承担的也是一个信息处理的角色</p>
</li>
<li><p>用户直接看到的<code>Excel</code>工作表整体可以分为四个部分</p>
</li>
<li><ul>
<li><strong>操作界面</strong>，就是使用者可以点击的一系列按钮</li>
<li><strong>数据处理过渡表格</strong>（可选，可以直接在内存中处理），就是一些计算借助了Excel工作表（类似于数组，看起来更直接）</li>
<li><strong>数据库</strong>，计算完的数据保存到这些工作表之中，输出时会用到其中的数据</li>
<li><strong>输出模板</strong>，信息处理后按照什么形式输出</li>
</ul>
</li>
<li><p>这个系列中重点介绍的<strong>Access</strong>替代的就是<strong>原数据库工作表</strong>这个部分，其中<code>ADO</code>&#x2F;<code>DAO</code>&#x2F;<code>SQL</code>都是操作<code>Access</code>的方法</p>
</li>
<li><p>整体的思路是将数据库从整个信息处理过程中独立出来，用专门方法去操作</p>
</li>
<li><p>那么为什么这么做？看看下篇</p>
</li>
</ol>
<h2 id="Part-2：Access"><a href="#Part-2：Access" class="headerlink" title="Part 2：Access"></a>Part 2：Access</h2><ol>
<li><p><strong>定义</strong>：Microsoft Office Access是由微软发布的关系数据库管理系统。它结合了 Microsoft Jet Database Engine 和 图形用户界面两项特点，是 Microsoft Office 的系统程序之一（百度百科）</p>
</li>
<li><p>这个系列中，对数据库的操作全部是后台进行的，都是通过<strong>代码</strong>实现的</p>
</li>
<li><p>本系列用的功能主要就是<code>Access</code>的表，其它的暂且不需要使用，所以理论上来说不需要了解<code>Access</code>软件的各个操作按钮，但是建议各位打开这个软件看看，有个感性认识</p>
</li>
<li><p>可以简单理解为<code>Excel</code>，也是由一个个工作表构成，只不过约束更多</p>
</li>
<li><p><code>Access</code>一个工作表的列称为<strong>字段</strong>，一行称为一个<strong>记录</strong>，这两点记住</p>
</li>
<li><p>为什么要使用<code>Access</code>，竟然主要使用的也是工作表，原因如下：</p>
</li>
<li><ul>
<li><code>Excel</code>文件过大时，例如超过50M，普通办公电脑处理起来就非常卡了</li>
<li><code>Access</code>支持2GB文件的处理，理论上允许255个人并发处理，这个基本上已经满足日常办公所需</li>
<li><code>Access</code>操作起来非常方便，对数据的管理很省心，例如增加一个新的记录只需一句<code>SQL</code>,而不用寻找存储具体的行号</li>
<li><code>Access</code>允许同时对多个工作表进行连接处理，就是很容易从不同的表获取关联信息，底层的寻找数据工作是<code>Access</code>系统自己处理的</li>
<li>如果你想在<strong>数据处理</strong>的道路上走的更远，数据库技术是必须要学习的</li>
</ul>
</li>
</ol>
<p><strong>Access界面</strong></p>
<p><img src="/./../img/640-1690871750266-28.jpeg" alt="图片"></p>
<p><strong>Access规格</strong>（Access软件打开后F1按钮，输入<strong>规格</strong>得到对应帮助文件）</p>
<p><img src="/./../img/640-1690871750267-29.jpeg" alt="图片"></p>
<h2 id="Part-3：ADO-x2F-DAO"><a href="#Part-3：ADO-x2F-DAO" class="headerlink" title="Part 3：ADO&#x2F;DAO"></a>Part 3：<code>ADO</code>&#x2F;<code>DAO</code></h2><ol>
<li><p><code>ADO</code>&#x2F;<code>DAO</code>类似于<code>FSO</code>使用前需先引用</p>
</li>
<li><p>对于新手建议可以采用前期引用，这样输入代码的时候会有提示，打开<code>Excel</code>的VBE界面，前期引用方法：工具菜单-引用，勾选</p>
</li>
<li><ul>
<li><code>Microsoft ActiveX Data Objects 2.8 Library</code></li>
<li><code>Microsoft DAO 3.6 Object Library</code></li>
<li>后续的代码使用都是默认大家已经勾选了这两个选项</li>
</ul>
</li>
<li><p>如果大家有看上一篇关于网页操作的：<a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484116&idx=1&sn=2c8d2555a40781836864d21a5d703426&chksm=ea811f79ddf6966f8d78e25adc04501846998f80ec6cab657bab3d355d942354aad13a331648&scene=21#wechat_redirect">VBA&#x2F;Excel-网页操作-01</a>，其实也是引用一个库，<code>VBA</code>的扩展库还是蛮多，有需求的可以研究一下</p>
</li>
<li><p>通过<code>ADO</code>&#x2F;<code>DAO</code>打通<code>Excel</code>与<code>Access</code>的连接</p>
</li>
</ol>
<p><strong>引用</strong></p>
<p><img src="/./../img/640-1690871750267-30.jpeg" alt="图片"></p>
<h2 id="Part-3：SQL"><a href="#Part-3：SQL" class="headerlink" title="Part 3：SQL"></a>Part 3：<code>SQL</code></h2><ol>
<li><strong>定义：</strong>结构化查询语言(Structured Query Language)简称SQL(发音：&#x2F;ˈes kjuː ˈel&#x2F; “S-Q-L”)，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名（百度百科）</li>
<li><code>SQL</code>不仅仅使用在<strong>Access</strong>这样的数据库，基本所有的关系型数据库都支持该语言，但是针对不同的数据库同一个操作写法上可能会有区别</li>
<li>这个系列中主要涉及的就是对数据库的<strong>增、删、建、改、查</strong></li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Access-VBA-目录]]></title>
      <url>/2023/08/01/Access-VBA-%E7%9B%AE%E5%BD%95/</url>
      <content type="html"><![CDATA[<p><strong>目录：</strong></p>
<blockquote>
<ol>
<li>Excel-Access-入门（Excel作为界面端，Access作为数据库）</li>
<li>Access-控件解析</li>
<li>Access-小示例</li>
<li>Access-大项目-培训管理系统</li>
<li>Excel-Excel-入门（Excel作为界面端，Excel作为数据库）</li>
</ol>
</blockquote>
<p><strong>Excel-Access-入门（Excel作为界面端，Access作为数据库）</strong></p>
<hr>
<ol>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484122&idx=1&sn=0587815bb9cb4d36e8a1106723b58f28&chksm=ea811f77ddf69661bcddeaa1d9bccd9a5a04d2486bda46b5c885a3627176235ac403118f1ec6&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-数据库-01</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484127&idx=1&sn=0b87098bc60444af4aa419a4c545fa0a&chksm=ea811f72ddf696641f98ab5f2d06a7c8bd12e7c9803fc0d6b885e8c80e6dda0afdef2182f82c&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-新建Access文件-02</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484136&idx=1&sn=cffcfc40d6486185e92f0d8a6d0ca35a&chksm=ea811f45ddf6965392e29519eae95bdbbf225feef8676cdc26d1238006455c03a6c83b295d82&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-Access表及字段创建-03</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484140&idx=1&sn=b6429db84d4ba8b7ae2bb9024e4b5dc7&chksm=ea811f41ddf696570352be40b399f50d1444a1f45f870aa0b694bfdf30b2957a29459ec21220&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-Access记录创建-04</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484144&idx=1&sn=400cba73e328a8d4792f50280f006877&chksm=ea811f5dddf6964b0d9130d2528db22353ce4ab721887f0f1515f1d6a340cf9a52a6e3fb19a2&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-Access记录修改-05</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484486&idx=1&sn=28c04338c3fe20f4db6a098765bdb21d&chksm=ea8119ebddf690fd8dc2b968de34d342235a2e5757595f179449bae6db07859ec62638607e77&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-Access记录删除-06</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484521&idx=1&sn=f3326992d6c4c86aea4d5096b196e128&chksm=ea8119c4ddf690d2f8e7883f9418a997f803ce103880c60225abd6e9c08e2ab34f5ef8a6419f&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-Access字段删除-07</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484554&idx=1&sn=149518da2ef1c7f9d86265cc223cfdfd&chksm=ea811927ddf69031cf35b1cb1be11bbfd6c16fbe3b9c2e19865c9cd3d9a94a7906c50acc2b10&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-获取数据库数据-08</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484570&idx=1&sn=d43c000c5aa85f5495baa63500754670&chksm=ea811937ddf690215c9e818a4954c2e30cf367924369ee87e109449ee088232d186cf47f56d2&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-单表筛选数据-09</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484591&idx=1&sn=a39c1e880f3fbfecf5cf4410ba66cc34&chksm=ea811902ddf690149dd24fd9f3887f2d49a22aad684d50e6e9581b567f6d8254fe9e952a0abe&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-多条件筛选数据-10</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484630&idx=1&sn=ccd2fb66805e8887b00a111f52d4cbf9&chksm=ea81197bddf6906dc449057e182f5e9fb3d166ee7df3c6acb45e6180be40aff98a24b6c9db7f&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-左连接-11</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484642&idx=1&sn=f853c3abea7799636e5e60ff37b0bc09&chksm=ea81194fddf69059d804d81e5d96915e9a24c45b60cd5cccd7c10aa70da1ea01441172bfd67d&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-12-模糊查询</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484654&idx=1&sn=5814bf972a362874a1c3f3218c0918c3&chksm=ea811943ddf69055d6f43b937c28f0104a2f79f83a90c0b58bdb9b8dd5dfaaac424d632f6d22&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-13-嵌套查询</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484667&idx=1&sn=f55663cd0499668dda1d1405cd3b620b&chksm=ea811956ddf6904054c7df67e5b9e532a03217323ef698071692426b4f9c384097c97c63c83a&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-14-消除重复值</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484692&idx=1&sn=a5e89c01799240aad808b26f6652587d&chksm=ea8118b9ddf691aff071cb4b85ae46d795e05e596a1dd3fa5ff981c9da3d98b785d96e6d3a4e&scene=21#wechat_redirect">Access&#x2F;VBA&#x2F;Excel-15-表信息整体迁移</a></li>
</ol>
<blockquote>
<p><strong>我是分界线</strong></p>
</blockquote>
<p><strong>Access-控件解析</strong></p>
<hr>
<ol>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484994&idx=1&sn=b3729e4ef33b10d4b5ba9c8405ff5153&chksm=ea811befddf692f97b7812dc9aa1124185880254014c650313f142dc6bc48ecbef868b69dac5&scene=21#wechat_redirect">Access-控件解析-列表框-01-多选数目获取</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485002&idx=1&sn=1bfe56af9b19f5a3efaca1783b6dbe25&chksm=ea811be7ddf692f1f1b88d1ed1ccf252a22a357ba70ffa4f6d5e3be0477b369bbe211e7674c3&scene=21#wechat_redirect">Access-控件解析-列表框-02-获取选项</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485114&idx=1&sn=04546a7120b3e61aa36c168b4ef94f19&chksm=ea811b17ddf692017db11d593e17e26bded90bde67de57784a41da56856723008c850ae32a97&scene=21#wechat_redirect">Access-控件解析-列表框-03-向列表框录入信息</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485179&idx=1&sn=2b456f8bd88177e34e229d5557bbea0f&chksm=ea811b56ddf69240998715b7a734279cca2d52f963c361a4f9d94bbe7329592fd02f0b3ae664&scene=21#wechat_redirect">Access-控件解析-列表框-04-双击效果</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485184&idx=1&sn=4dc97db44facf92e1196a9ffc40dbcbf&chksm=ea811aadddf693bb8ccce328c343bbea01289f74e68d96de868bb8b40937be6a95dbf92348e9&scene=21#wechat_redirect">Access-控件解析-组合框-01-下拉列表</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485205&idx=1&sn=ff50515a46aef487ac7da9e25eebac12&chksm=ea811ab8ddf693aef9b152687b57f687c1cca26389ec59779bd87fce685c31105ffe45081a8b&scene=21#wechat_redirect">Access-控件解析-组合框-02-两个组合框联动</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485270&idx=1&sn=cb6b307725b606ae7a84a2967fe20f76&chksm=ea811afbddf693ed8d65723871ec3ecf9c0183c255a4344cdbc3b54474131621ad0c7ed3bf0a&scene=21#wechat_redirect">Access-控件解析-文本框-01-格式设置</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485294&idx=1&sn=e4d8e98324266a3228a3d74446b751b2&chksm=ea811ac3ddf693d5e72a23986c81162c3b6d47c69d8796f1d73dc7a9d80de1d616edae7533c7&scene=21#wechat_redirect">Access-控件解析-按钮-01-关联代码</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485299&idx=1&sn=8119fb142d5a22b693a3423b532ef0d8&chksm=ea811adeddf693c87b375ddd86965f68850369b20f9d94bf8b7314d8e01cf01d8ad9d5543867&scene=21#wechat_redirect">Access-控件解析-按钮-02-来个双击</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485311&idx=1&sn=518208b96e505b71a88284e4b60a2e23&chksm=ea811ad2ddf693c4854e0f73f001078ecfd8263a847b759bba439ede993bca927164014be9d0&scene=21#wechat_redirect">Access-控件解析-标签-01-控件提示</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485320&idx=1&sn=bd3e612b8f2a0e4130665582175829be&chksm=ea811a25ddf69333bc81ed36e59d6df96782b539a7bf60fc95f0d93b721b45ac45b05d2df357&scene=21#wechat_redirect">Access-控件解析-窗体-01-弹出</a></li>
</ol>
<blockquote>
<p><strong>我是分界线</strong></p>
</blockquote>
<p><strong>Access-小示例</strong></p>
<hr>
<ol>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485340&idx=1&sn=5d191556de83e156c79bc8b488150270&chksm=ea811a31ddf69327a821c27cf221b92fa6ed93a7819031a5355b39ed05d89e4ddaabba5b636d&scene=21#wechat_redirect">Access-常用功能解析-01-账户权限管理</a>（Environ(“username”)）</li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485620&idx=1&sn=18cbace8c97db797bded35293b61221b&chksm=ea811519ddf69c0f750cc63ccfcbf00c3e5a01a3c34c5dfd05bca505a25397375994e6ea1a49&scene=21#wechat_redirect">Access-小示例-02-连接mdb数据库</a></li>
</ol>
<blockquote>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247483868&idx=1&sn=2c695bf89caee63b612f3df5161c01ae&scene=21#wechat_redirect"><strong>我是分界线</strong></a></p>
</blockquote>
<p><strong>Access-实战项目-培训管理系统</strong></p>
<hr>
<ol>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484735&idx=1&sn=bc7f1f6616ff2154cc300c71a1a9e6ae&chksm=ea811892ddf691849e0b4e0191c4de533e7ff9be9d118a17ebabceb9069f3b9b62832f3aa62d&scene=21#wechat_redirect">Access-培训管理系统-01-概括</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484747&idx=1&sn=23f7218a970b782cd5f1c38775be8abc&chksm=ea8118e6ddf691f052b1d3137ad848ada4210204ea3f21fc51c6495d3a96ee2013684edf7a91&scene=21#wechat_redirect">Access-培训管理系统-02-来个界面</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484768&idx=1&sn=030ffbfc406ef1f4c91785d05a01e9f6&chksm=ea8118cdddf691db9a0331cfd6cb7d9c6c40f4bec07aa03c741c23f5e1c90902147a1a87b0f3&scene=21#wechat_redirect">Access-培训管理系统-03-建个数据库</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484793&idx=1&sn=ba9af6227774e79fc353c9a6a0700326&chksm=ea8118d4ddf691c29c319c5c2d43801aaf8726375845d0857c0107011fff94bba7eb58192b52&scene=21#wechat_redirect">Access-培训管理系统-04-清空界面及下拉列表实现（上篇）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484801&idx=1&sn=710af2e5d3132990dd875be27b38aa22&chksm=ea81182cddf6913a28aba7fd23296b30db425d9b672d3fc81789dc048820863b3f186f293192&scene=21#wechat_redirect">Access-培训管理系统-04-清空界面及下拉列表实现（下篇）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484814&idx=1&sn=3d0c745504a73e8693cd08f58a97b0c2&chksm=ea811823ddf691352b701e3727339558a25e4d60ec84b181559ac298984cba4c53c08ae87304&scene=21#wechat_redirect">Access-培训管理系统-06-按钮代码设置之 清空所有</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484824&idx=1&sn=d4185218c90ecce0b53c26e21ca3aa9f&chksm=ea811835ddf69123534f51624f2f23825d056df0200b5ebd0e82e99c2381ef97500d204f1dee&scene=21#wechat_redirect">Access-培训管理系统-07-按钮代码设置之增加学员</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484833&idx=1&sn=9cb70f94f09f3954fdd4cca50aaee830&chksm=ea81180cddf6911ab24fa7800da58e41616b677086b7d2f1d9f19f0bedd282db65a625fff922&scene=21#wechat_redirect">Access-培训管理系统-08-按钮代码设置之 删除所选行</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484846&idx=1&sn=dc5787dd73ca503dbb337dfebe49912a&chksm=ea811803ddf69115522b6865362b4d9660113f650db18e44d729121bcade9d12ea168390ab30&scene=21#wechat_redirect">Access-培训管理系统-09-按钮代码设置之 录入（1）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484856&idx=1&sn=665b468e7dc524d2210c4e6d529bfa2a&chksm=ea811815ddf691032b503b4d34204a505238e2aa349542aaa29a0a9ed7708ff08571f6dd79ab&scene=21#wechat_redirect">Access-培训管理系统-10-按钮代码设置之 录入（2）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484878&idx=1&sn=51629a522870d683181b2be37de5d526&chksm=ea811863ddf69175121951b227297dfb7c5f2977c23b32317446d21e0ad8d2e81324a4d4986c&scene=21#wechat_redirect">Access-培训管理系统-11-按钮代码设置之 录入（3）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247484961&idx=1&sn=540edd3eb1f8cb86aeee0cc93c3a520c&chksm=ea811b8cddf6929a88fa40c57dd570d918d7c6b882e1aa23d80192892cea0718ab1f53fbdb88&scene=21#wechat_redirect">Access-培训管理系统-12-输出界面</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485021&idx=1&sn=7107a67e4cbc1b265909cfdeba05e519&chksm=ea811bf0ddf692e6c8ddde1f47fb8e81a37c22be1629c8f1b175c0217ed93676672f80fa30c9&scene=21#wechat_redirect">Access-培训管理系统-13-输出个人培训档案</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485028&idx=1&sn=b6c5b12534e6bbd47990ebba04c2787b&chksm=ea811bc9ddf692df03b68c67cebdd340b1a80cdb215870342a0d1e8e898ed3aa581ba7264ef0&scene=21#wechat_redirect">Access-培训管理系统-14-输出老师上课记录</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485034&idx=1&sn=b33d88dd04db8ebcf2de63776dfe1d18&chksm=ea811bc7ddf692d1b3aba73ef72526bc99b45815a36f654bcef8034f9aa7779bc33bcfe329c5&scene=21#wechat_redirect">Access-培训管理系统-15-输出所有老师上课记录</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485043&idx=1&sn=ca29bce9c43ffe8f0884b5ebd259cb09&chksm=ea811bdeddf692c828d6f3eff5b1133f7daf12c892e5016f2667f93a701b711e3d7b99fdab5e&scene=21#wechat_redirect">Access-培训管理系统-16-首页</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI2NzM0MDk5NA==&mid=2247485254&idx=1&sn=c11b9d3d6826d63bd58886a2dc9f624a&chksm=ea811aebddf693fda784a23c12964990155180bb621ab0f55171fc7a561c11cbf7f072f79591&scene=21#wechat_redirect">Access-培训管理系统-17-番外篇-程序发布</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> vba-access </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> access </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[微信图文编辑器-Markdown]]></title>
      <url>/2023/08/01/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E6%96%87%E7%BC%96%E8%BE%91%E5%99%A8-Markdown/</url>
      <content type="html"><![CDATA[<p>今天推荐的开源项目可以将 Markdown 文档自动即时渲染为微信图文，还可以自动排版，支持自定义 CSS 样式，最终什么样式你可以自己定义。</p>
<p>也就是说你只需要在 Markdown 编辑器上写文章，就能一键生成一篇样式简洁而又美观大方的微信图文，这就大大提高了你的效率，不用每天去排版了。</p>
<p>图片怎么办？别担心，这个开源项目还支持 GitHub、阿里云、腾讯云、七牛云 等图床。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">开源地址：https://github.com/doocs/md</span><br></pre></td></tr></table></figure>

<h2 id="功能特性"><a href="#功能特性" class="headerlink" title="功能特性"></a><strong>功能特性</strong></h2><ul>
<li>支持 Markdown 所有基础语法</li>
<li>支持浅色、暗黑两种主题模式</li>
<li>支持 Ctrl + F 快速格式化文档</li>
<li>支持色盘取色，快速替换文章整体色调</li>
<li>支持多图上传，可自定义配置图床</li>
<li>支持自定义上传逻辑</li>
<li>支持在编辑框右键弹出功能选项卡</li>
<li>支持批量转换本地图片为线上图片</li>
</ul>
<p><img src="/./../img/740.gif" alt="图片"><img src="/./../img/640-1690869329948-4.gif" alt="图片"><img src="/./../img/640-1690869352746-8.gif" alt="图片"></p>
]]></content>
      
        <categories>
            
            <category> github </category>
            
        </categories>
        
        
        <tags>
            
            <tag> markdown </tag>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[excel-vba 数据库操作方式]]></title>
      <url>/2023/07/28/excel-vba-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h4 id="一、卡点："><a href="#一、卡点：" class="headerlink" title="一、卡点："></a>一、卡点：</h4><p><img src="/./../img/image-20230728134957123.png" alt="image-20230728134957123"></p>
<p>这个问题是用wps连接的OLEDB（access数据库）, 用excel打开就没有问题，如果用wps就需要用其他方式</p>
<p><strong>excel：</strong></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> con <span class="keyword">As</span> ADODB.Connection</span><br><span class="line"><span class="keyword">Set</span> con = <span class="built_in">New</span> ADODB.Connection <span class="comment">&#x27;对象变量赋值必须用set</span></span><br><span class="line">` 建立数据连接    </span><br><span class="line">con.Open <span class="string">&quot;provider=Microsoft.ACE.OLEDB.16.0;data source=&quot;</span> &amp; _</span><br><span class="line">    ThisWorkbook.Path &amp; <span class="string">&quot;\基础数据.accdb&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>wps：</strong></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> con <span class="keyword">As</span> <span class="built_in">New</span> ADODB.Connection</span><br><span class="line">con.Open <span class="string">&quot;provider=microsoft.jet.oledb.4.0;extended properties=excel 8.0;data source=&quot;</span> &amp; ThisWorkbook.Path &amp; <span class="string">&quot;/test2.xls&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="二、access-数据库操作指南"><a href="#二、access-数据库操作指南" class="headerlink" title="二、access 数据库操作指南"></a>二、access 数据库操作指南</h4><ul>
<li><strong>第一步：</strong>告诉电脑我要用ADO了，</li>
</ul>
<p>​	<em><strong>这个操作在【工具】–&gt; 【引用】–&gt; 【Microsoft ActiveX Data Objects 6.1 	Libray】</strong></em></p>
<p><img src="/./../img/image-20230728143220859.png" alt="image-20230728143220859"></p>
<ul>
<li><strong>第二步：</strong>创建连接对对象</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&#x27; 2-1 声明对象变量名</span></span><br><span class="line"><span class="keyword">Dim</span> con <span class="keyword">As</span> ADODB.Connection</span><br><span class="line"> <span class="comment">&#x27; 2-2 创建对象变量并赋值</span></span><br><span class="line"><span class="keyword">Set</span> con = <span class="built_in">New</span> ADODB.Connection <span class="comment">&#x27;对象变量赋值必须用set</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>第三步：</strong>连接数据库</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27; 建立数据库连接</span></span><br><span class="line">con.Open <span class="string">&quot;provider=Microsoft.ACE.OLEDB.16.0;data source=&quot;</span> &amp; _</span><br><span class="line">ThisWorkbook.Path &amp; <span class="string">&quot;\基础数据.accdb&quot;</span></span><br></pre></td></tr></table></figure>

<p><em>(注意这个部分，OLEDB, 2007以上是12.0，一下是8.0或4.0)</em></p>
<ul>
<li><strong>第四步：</strong>执行sql语句</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;插入记录：insert into 表名 （字段1，字段2，...） values(值1，值2，...)</span></span><br><span class="line"><span class="keyword">Dim</span> sql <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">sql = <span class="string">&quot;insert into TEST(测试1,测试2,测试3) values(&#x27;a09&#x27;,&#x27;D文学员&#x27;,&#x27;6999&#x27;)&quot;</span></span><br><span class="line"><span class="comment">&#x27; 执行sql</span></span><br><span class="line">con.Execute (sql)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>第五步：</strong> 关闭数据库连接，并释放变量（一定要）</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">con.Close</span><br><span class="line"><span class="comment">&#x27; 释放变量</span></span><br><span class="line"><span class="keyword">Set</span> con = <span class="literal">Nothing</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="三、数据库语法"><a href="#三、数据库语法" class="headerlink" title="三、数据库语法"></a>三、数据库语法</h4><pre><code> 1. **数据常见的`增`、`删`、`改`、`查`**
</code></pre>
<ul>
<li><strong>增加数据</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sub</span> InsetSql()</span><br><span class="line">    <span class="keyword">Dim</span> sql <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    sql = <span class="string">&quot;insert into TEST(测试1,测试2,测试3) values(&#x27;a09&#x27;,&#x27;D文学员&#x27;,&#x27;6999&#x27;)&quot;</span></span><br><span class="line">    <span class="comment">&#x27; 执行sql</span></span><br><span class="line">    con.Execute (sql)</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>删除数据</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DelSql()</span><br><span class="line">    <span class="comment">&#x27;删除数据： delete from 表名 [where 条件]</span></span><br><span class="line">    <span class="keyword">Dim</span> sql <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    sql = <span class="string">&quot;delete from TEST where id=2&quot;</span> <span class="comment">&#x27;如果是字符串需要加&#x27;&#x27;</span></span><br><span class="line">    con.Execute (sql)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>修改数据</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> UpdateSql()</span><br><span class="line">    <span class="comment">&#x27;更新记录 update 表名 set 字段=值 [where 条件]</span></span><br><span class="line">    <span class="comment">&#x27; 多条件更新 update 表名 set 字段1=值1，字段2=值2 where 条件</span></span><br><span class="line">    <span class="comment">&#x27; 如果要使用变量的化，一定要在“号的外面</span></span><br><span class="line">    <span class="comment">&#x27; &quot;update 表名 set 字段1=值1，字段2=&#x27;&quot;&amp; 变量 &amp; &quot;&#x27; where 条件&quot; 注意&#x27;</span></span><br><span class="line">    <span class="keyword">Dim</span> sql <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    sql = <span class="string">&quot;update TEST set 测试1=&#x27;a088&#x27; where 测试3=&#x27;999&#x27;&quot;</span></span><br><span class="line">    con.Execute (sql)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>查找数据</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SelectSql()</span><br><span class="line"> 	<span class="keyword">Dim</span> sql <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    sql = <span class="string">&quot;select * from TEST&quot;</span></span><br><span class="line">	con.Execute (sql)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span>    </span><br></pre></td></tr></table></figure>

<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;书写sql命令字符串</span></span><br><span class="line">sql = <span class="string">&quot;select * from 院校&quot;</span>                                  	<span class="comment">&#x27;查询全部字段</span></span><br><span class="line">sql = <span class="string">&quot;select 姓名，性别，职称 from 导师&quot;</span>        				 	<span class="comment">&#x27;指定部分字段</span></span><br><span class="line">sql = <span class="string">&quot;select distinct 研究方向 from 学生&quot;</span>        		    	<span class="comment">&#x27;提取不重复记录</span></span><br><span class="line">sql = <span class="string">&quot;select 课程代码，成绩 from 成绩 order by 成绩 asc&quot;</span> 		 	<span class="comment">&#x27;排序</span></span><br><span class="line">sql = <span class="string">&quot;select *，2006 from 学生&quot;</span> 							   <span class="comment">&#x27;生成新的字段</span></span><br><span class="line">sql = <span class="string">&quot;select 学号，姓名，性别，year(入学日期) as 年份 from 学生&quot;</span>  <span class="comment">&#x27;根据年份查找对应字段</span></span><br><span class="line">sql = <span class="string">&quot;selcet 姓名，性别 from union select 姓名，性别 from 导师&quot;</span> </span><br><span class="line"><span class="comment">&#x27; union：去除重复，并按照第一个字段升序排序</span></span><br><span class="line"><span class="comment">&#x27; union all 全部复制，重复的也不管，不排序</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>数据库记录集</strong></li>
</ol>
<blockquote>
<p>通过查询或其他方式获取数据后，需要存放在一个记录集对象中</p>
<ul>
<li><p>创建一个记录集对象，创建记录集主要有两个方法(第二种用的最多)</p>
</li>
<li><p>第一中不能修改记录集对象，第二种可以修改</p>
</li>
<li><p>使用 <code>Set rs = con.Execute(sql)</code> 语句可以直接执行 SQL 查询，并将结果集赋值给记录集对象 <code>rs</code>。这种方法适用于执行 SQL 查询并将结果保存在记录集中。</p>
</li>
<li><p>使用 <code>rs.Open sql, con, adOpenReyset, adLicjOptimistic</code> 语句可以在已经创建的记录集对象 (<code>rs</code>) 上打开一个结果集。这个方法可以用于在已经存在的记录集对象上重新打开一个新的结果集。</p>
</li>
</ul>
</blockquote>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> rs <span class="keyword">As</span> <span class="built_in">New</span> ADODB.Recordset <span class="comment">&#x27;创建了一个记录集对象</span></span><br><span class="line"><span class="keyword">Set</span> rs = con.Execute(sql)  <span class="comment">&#x27;这是一个记录集</span></span><br></pre></td></tr></table></figure>

<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> rs = <span class="built_in">New</span> ADODB.Recordset <span class="comment">&#x27;创建记录集对象</span></span><br><span class="line">rs.Open sql, con, adOpenRecordset, adLockOptimistic</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>获取记录集中的字段</strong>，需要用<code>Fields.name</code></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;获取字段名需要一个循环</span></span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> rs.Fields.Count - <span class="number">1</span></span><br><span class="line">	Cells(<span class="number">1</span>, i + <span class="number">1</span>) = rs.Fields(i).Name</span><br><span class="line"><span class="keyword">Next</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>将记录集返回到数据表</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sheets(<span class="string">&quot;sheet1&quot;</span>).Range(<span class="string">&quot;A2&quot;</span>).CopyFromRecordset rs  <span class="comment">&#x27;可以直接定位到当前的单元格，sheets(&quot;sheet1&quot;）可加可不加</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>释放对象变量空间</strong></li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;释放对象变量空间</span></span><br><span class="line">rs.Close: <span class="keyword">Set</span> rs = <span class="literal">Nothing</span></span><br><span class="line">con.Close: <span class="keyword">Set</span> con = <span class="literal">Nothing</span>    </span><br></pre></td></tr></table></figure>

<h4 id="四、多表查询（where连接"><a href="#四、多表查询（where连接" class="headerlink" title="四、多表查询（where连接)"></a>四、多表查询（where连接)</h4><ul>
<li><strong>案例1：</strong>查询所有学生的姓名、性别、选修的课程名称及成绩</li>
</ul>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 姓名，性别，课程名称，成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 学生，课程，成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; where 学生.学号=成绩.学号 and 课程.课程代码=成绩.成绩代码&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>案例2：</strong>查询“王维欣”同学的性别、选修的课程名称及考试成绩</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 性别，课程名称，成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 学生，课程，成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; where 学生，学号=成绩.学号 and 课程.课程代码=成绩.课程代码&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; and 姓名=&#x27;王维欣&#x27;&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="五、多表查询（内连接）"><a href="#五、多表查询（内连接）" class="headerlink" title="五、多表查询（内连接）"></a>五、多表查询（内连接）</h4><ul>
<li><strong>案例1：</strong>查询所有课程的平均成绩，结果包含课程名称，平均成绩两个字段</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 课程名称，avg(成绩) as 平均成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 课程 inner join 成绩 on 课程.课程代码=成绩.课程代码&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>案例2：</strong> 查询所有课程的平均成绩，结果包含课程名称，平均成绩两个字段，平均成绩要大于85分</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 课程名称，avg(成绩) as 平均成绩&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 课程 inner join 成绩 on 课程.课程代码=成绩.课程代码&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; group by 课程名称 having avg(成绩)&gt;=85&quot;</span></span><br></pre></td></tr></table></figure>

<p>（sql语句的执行顺序是: from –&gt; where –&gt; group –&gt; having –&gt; select）</p>
<h4 id="六、多表查询（外连接）"><a href="#六、多表查询（外连接）" class="headerlink" title="六、多表查询（外连接）"></a>六、多表查询（外连接）</h4><blockquote>
<p>基本格式： from 左表 连接类型  右表 on 连接条件</p>
</blockquote>
<ul>
<li><strong>案例1：</strong>查询所有导师的院系信息，包含姓名，性别，职称，系号、系名</li>
</ul>
<p>​	<code>左连接：左边连接字段有的，而右表没有的，左表全部显示，右表留空</code></p>
<p><code>(根据左表查右表)</code></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 姓名，性别，职称，系号，系名 &quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 导师 left join 院系 on 导师.院系编号=院系.系号&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>案例2：</strong>查询所有院系的导师信息，包含系号、系名、姓名、职称</li>
</ul>
<p><code>右连接：右表连接字段有的，而左表没有的，右边全部显示，左表留空</code></p>
<p><code>（根据右表查左表）</code></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 系号，系名，姓名，职称&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 导师 right join 院系 on 导师.院系编号=院系.系号&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>案例3：</strong>查询所有导师、所有院系的信息，包含姓名、性别、职称、系号、系名</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 姓名，性别，职称，系号，系名&quot;</span> _</span><br><span class="line">&amp; <span class="string">&quot; from 导师 full join 院系 on 导师.院系编号=院系.系号&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="七、多表查询（自连接）"><a href="#七、多表查询（自连接）" class="headerlink" title="七、多表查询（自连接）"></a>七、多表查询（自连接）</h4><p><code>含义：自己连接自己</code></p>
<ul>
<li><strong>案例1：</strong>查询员工表中姓名有重复的员工记录(刷出全部记录看看)</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select * from 员工 t1 inner join 员工 t2 on t1.姓名=t2.姓名&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="八、子查询（嵌套查询）"><a href="#八、子查询（嵌套查询）" class="headerlink" title="八、子查询（嵌套查询）"></a>八、子查询（嵌套查询）</h4><ul>
<li><strong>案例1：</strong>查询每个部门年龄在30岁以上的员工的平均年龄</li>
</ul>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">&quot;select 部门，count(*) as 人数 from 员工 where 年龄&gt;30 group by 部门&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>案例2：</strong> 查询年龄高于平均年龄的员工信息，包含姓名、身份证号、部门、年龄职务</p>
</li>
<li><p><strong>案例3：</strong> 查询年龄排在第5-10名的员工信息，包含姓名、身份证号、部门、年龄职务</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> excel </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
            <tag> vba </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[记录我的小项目-第二弹]]></title>
      <url>/2023/07/28/%E8%AE%B0%E5%BD%95%E6%88%91%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE-%E7%AC%AC%E4%BA%8C%E5%BC%B9/</url>
      <content type="html"><![CDATA[<h4 id="一、项目起因："><a href="#一、项目起因：" class="headerlink" title="一、项目起因："></a>一、项目起因：</h4><blockquote>
<p>前段时间开会，跟公司快递营销组两位同事闹了点不愉快，这个原因是两方面的：第一是因为也是对工作项确实不太清楚（说实话，官僚主义太严重，全是形式主义，扣字眼一个比一个厉害，整一些形式主义的东西，什么三大标准化，要必须产出，也没明白什么是三大标准，不清楚怎么定义，也不清楚什么算什么标准，怎么提交怎么弄）第二是对这项工作的不认可（业务本身是千变万化的，标准是在工作中形成的，不清楚这件事对项目有什么帮助，在产品还在定义中，出标准化有什么意义。花大量的时间做了一些纸面文档【说多了，算是吐槽吧】）后来被批了，想想也没什么，思想本身也无法统一也无法调和，只能低头默认（得吃饭呀），后来挨批了一顿，然后想想怎么缓和下关系（写到这里，突然觉得自己活成自己讨厌的样子了，社会发展，个人成长，环境适应）</p>
<p>针对这件事，自己也有问题，对事情的不认可可以向上提出，可以无法接收文化离开，可以沉默隐忍接受，但是不应该对项目里执行的人出言刁难，（本意并非如此，只是提出了疑问，没想到点了炸药包，确实不知三大标准化是什么）尤其不应该对一个小专员，然她下不来台。现在也没到权力斗争的底部，搞掉别人对自己也没什么好处，自己的思维和工作方式的问题，也需要检讨。</p>
<p>后来想想，自己在以前的工作中做过一个《培训管理系统》就琢磨给你们用excel也做一个自动化系统吧，算是关系的缓和，也不是有意刁难的，这个事情也算过去了</p>
</blockquote>
<h4 id="二、使用工具："><a href="#二、使用工具：" class="headerlink" title="二、使用工具："></a>二、使用工具：</h4><p>​	<strong>wps</strong>：<em>最新版就可以</em></p>
<p>​	<strong>excel：</strong><em>最好是2017-2023版</em></p>
<p>​	<strong>WPS宏插件：</strong> <a href="https://wws.lanzout.com/inOQs0nmaf3e">VBA宏插件（含安装说明）.rar</a></p>
<p>​	密码：1234 提取码：yypd</p>
<p>​	<strong>access数据库：</strong></p>
<ul>
<li>​	office_ tool  <a href="https://www.uy5.net/download/?path=00019700101000000001/1611iptRY1EL05620230205234842x9v/1611iptRY1EL078202210220137074zo/1611iptRY1EL0582023041602553503b/1611iptRY1EL05620230416025622hvd">Office_Tool_with_runtime_v10.1.3.4.zip</a></li>
<li>​     破解工具 <a href="https://www.uy5.net/download/?path=00019700101000000001/1611iptRY1EL05620230205234842x9v/1611iptRY1EL078202210220137074zo/1611iptRY1EL05420230503093148fly/1611iptRY1EL07820230503093254zq4"> ReBirth Activator 1.4.zip</a></li>
</ul>
<p>​	<strong>sqlServer数据库：</strong><a href="https://www.zhihu.com/tardis/bd/art/59017254?source_id=1001">SQLserver 安装教程</a></p>
<h4 id="三、项目需求："><a href="#三、项目需求：" class="headerlink" title="三、项目需求："></a>三、项目需求：</h4><ol>
<li>可以分发数据，让销售自己的数据看自己</li>
<li>可以有一个数据对照，因为用“vlookup”有时候会出错（销售填写的表格有时候会加一个空格）</li>
<li>有一个数据看板和查找系统</li>
</ol>
<h4 id="四、项目思考："><a href="#四、项目思考：" class="headerlink" title="四、项目思考："></a>四、项目思考：</h4><ol>
<li><p>根据现有的信息来看，无法通过钉钉进行文件共享，通过公式来满足</p>
</li>
<li><p>数据库有两套方案：</p>
<p>(1). 用传统的数据库进行，access，sqlServer</p>
<p>​	优势：数据库安全，易操作，数据调用方便</p>
<p>​	劣势：需要给他人电脑安装access数据库和sqlserver，比较麻烦</p>
<p>(2).用excel 的xls 作为数据库，ocdb 用 jet，通过共享文件进行</p>
<p>​	优势： 简单方便，wps也能用</p>
<p>​	劣势：数据不安全，不确定效率如何，另外是否也需要给别人的电脑安装OCDB不确定</p>
</li>
<li><p>数据分配方式：</p>
<p>准备多个表格，用名字区分，每人一个（简单易行就好了，不整太复杂的）用数据库区分</p>
</li>
<li><p>数据展示：</p>
<p>看下模板，有合适的模板直接套用，加代码就可以了</p>
</li>
</ol>
<h4 id="五、项目逻辑："><a href="#五、项目逻辑：" class="headerlink" title="五、项目逻辑："></a>五、项目逻辑：</h4><ol>
<li>将所有的数据放入数据库，中台可以获取所有的数据，给中台加入一个数据获取按钮，获取最新的所有数据，数据最好是更新过来的（因为数据量有几千条，不能所有数据一起更新）</li>
<li>中台做一个数据分配按钮（每天更新一次数据，分配给销售）</li>
<li>销售一人准备一个表，做数据的提交，注意限制原始数据的改动</li>
</ol>
<h4 id="六、项目计划："><a href="#六、项目计划：" class="headerlink" title="六、项目计划："></a>六、项目计划：</h4><ol>
<li>测试数据库：测试access，及xlsx</li>
<li>找合适的表模板</li>
<li>敲代码</li>
</ol>
<h4 id="七、具体实现："><a href="#七、具体实现：" class="headerlink" title="七、具体实现："></a>七、具体实现：</h4><p>​	见：</p>
<h4 id="八、项目指标："><a href="#八、项目指标：" class="headerlink" title="八、项目指标："></a>八、项目指标：</h4><p>​	暂未涉及</p>
<p>​	&#x3D;&#x3D; 当前项目进展：&#x3D;&#x3D;</p>
]]></content>
      
        <categories>
            
            <category> 项目日记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 项目集锦 </tag>
            
            <tag> excel </tag>
            
            <tag> 销售流程 </tag>
            
            <tag> vba </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用免费国外服务器搭建ChatGPT接口服务[附注册教程/源码]]]></title>
      <url>/2023/06/26/%E4%BD%BF%E7%94%A8%E5%85%8D%E8%B4%B9%E5%9B%BD%E5%A4%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BAChatGPT%E6%8E%A5%E5%8F%A3%E6%9C%8D%E5%8A%A1-%E9%99%84%E6%B3%A8%E5%86%8C%E6%95%99%E7%A8%8B-%E6%BA%90%E7%A0%81/</url>
      <content type="html"><![CDATA[<p>最近这段时间，ChatGPT火的一塌糊涂，到处都是介绍ChatGPT的文章，但自从前段时间开始，很多人可能都发现了ChatGPT接口国内调用不了了，而很多人可能是抱着玩玩的心态，并不愿意去花钱另外购买国外的服务器，当然这其中也包括我，由于没有预算去购买一台国外的服务器，所以我公众号的ChatGPT功能也被迫停止运行了一段时间，但是今天我想告诉大家，<strong>本站公众号ChatGPT服务重启了</strong>，还是之前的使用方式，但是速度快了很多，有兴趣的朋友可以去关注公众号去体验，不知道怎么用的可以看公众号的“使用帮助”。</p>
<p>回到正题，虽然我重启了公众号的ChatGPT功能，但是我并没有额外花钱，因为我找到了免费的国外服务器，它不香吗？？？市面上提供服务器免费试用的厂商不少，比如阿里云、亚马逊等等，但是注册比较麻烦，需要信用卡，国外手机号、国外身份信息等等之类的信息，我最先也是准备注册阿里云，后来卡在了手机号这块儿，免费的手机号根本注册不了，而我又不想花钱去买验证码，直到最后我找到了hostbuddy这个网站，全程只需要一个邮箱即可，下面介绍一下注册流程。</p>
<p><strong>一、hostbuddy注册</strong></p>
<p><strong>1、注册账号</strong></p>
<p>首先我们访问hostbuddy官网，地址：<a href="https://www.hostbuddy.com/%EF%BC%8C%E5%B9%B6%E7%82%B9%E5%87%BB%E2%80%9CGET">https://www.hostbuddy.com/，并点击“GET</a> STARTED”按钮，</p>
<p><img src="/./../img/vcbxe-1688378723958-18.png" alt="图片"></p>
<p>填写注册信息，并点击注册</p>
<p><img src="/./../img/dbxcvb-1688378731501-21.png" alt="图片"></p>
<p>不出意外的话，我们会进入以下界面</p>
<p><img src="/./../img/fdvv-1688378734880-24.png" alt="图片"></p>
<p><strong>2、验证账号</strong></p>
<p>进入注册账号时填写的邮箱，找到激活邮件，并点击激活链接</p>
<p><img src="/./../img/fghdf-1688378738393-27.png" alt="图片"></p>
<p><strong>3、登录账号</strong></p>
<p>账号成功激活后会转向到登录页，填写我们注册的账号并登录</p>
<p><img src="/./../img/fghdfg-1688378742077-30.png" alt="图片"></p>
<p><strong>4、激活试用计划</strong></p>
<p>首次登录完毕之后我们需要激活我们的试用计划，点击“Try Now”</p>
<p><img src="/./../img/asfahcv-1688378745049-33.png" alt="图片"></p>
<p>可以看到默认的地区是美国，刚好可以用于我们访问ChatGPT服务，然后我们填入密码和网站名，这里的密码就是后面我们登录FTP的密码，网站名就是网站的目录名称，然后点击“Next”</p>
<p><img src="/./../img/fgdfg-1688378747991-36.png" alt="图片"></p>
<p>确认信息并点击“提交”</p>
<p><img src="/./../img/agdg-1688378750426-39.png" alt="图片"></p>
<p>此时不要关闭窗口，需要等待激活完成，一般1-3分钟</p>
<p><img src="/./../img/bsfb-1688378753182-42.png" alt="图片"></p>
<p><strong>5、创建node应用</strong></p>
<p>在激活完成后，我们登录主机面板并创建node应用，</p>
<p><img src="/./../img/gweg-1688378756006-45.png" alt="图片"></p>
<p><img src="/./../img/567356-1688378759503-48.png" alt="图片"></p>
<p>这里显示了我们的FTP登录信息和对外域名，我们点击“管理网站”并点击“NodeJs“进入node应用创建界面</p>
<p><img src="/./../img/34567-1688378762811-51.png" alt="图片"></p>
<p>按序号依次点击完成node应用的创建，需要注意的是当激活NodeJS后，所有的javascript将会被当作NodeJS运行。</p>
<p><strong>6、登录FTP</strong></p>
<p>在node应用创建完成后，我们用步骤5截图中显示的FTP信息和步骤4设置的密码登录FTP，登录后目录结构如下：</p>
<p><img src="/./../img/246246-1688378766105-54.png" alt="图片"></p>
<p>“www”即为存放网站源码的目录，我们进入目录</p>
<p><img src="/./../img/352345-1688378768975-57.png" alt="图片"></p>
<p>目录中有2个文件，default.asp是网站的默认页，我们需要删除掉，web.config是网站的配置文件。</p>
<p><strong>7、测试node应用</strong></p>
<p>在node应用创建完毕后我们就可以开始测试了，创建app.js， 并编写如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;Hello, world!&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(process.<span class="property">env</span>.<span class="property">PORT</span>);</span><br></pre></td></tr></table></figure>

<p>注意这里不能自定义端口，必须使用process.env.PORT。将app.js文件传到www目录下，并更改配置文件如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">handlers</span>&gt;</span>            </span><br><span class="line">            <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;iisnode&quot;</span> <span class="attr">path</span>=<span class="string">&quot;*.js&quot;</span> <span class="attr">verb</span>=<span class="string">&quot;*&quot;</span> <span class="attr">modules</span>=<span class="string">&quot;iisnode&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">handlers</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;<span class="name">rewrite</span>&gt;</span>            </span><br><span class="line">            <span class="tag">&lt;<span class="name">rules</span>&gt;</span>                </span><br><span class="line">                <span class="tag">&lt;<span class="name">rule</span> <span class="attr">name</span>=<span class="string">&quot;mysite&quot;</span>&gt;</span>                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">match</span> <span class="attr">url</span>=<span class="string">&quot;/*&quot;</span> /&gt;</span>                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">action</span> <span class="attr">type</span>=<span class="string">&quot;Rewrite&quot;</span> <span class="attr">url</span>=<span class="string">&quot;app.js&quot;</span> /&gt;</span>                </span><br><span class="line">                <span class="tag">&lt;/<span class="name">rule</span>&gt;</span>            </span><br><span class="line">            <span class="tag">&lt;/<span class="name">rules</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">rewrite</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问步骤5中获取的对外域名，如果页面显示”Hello, world!“则测试通过。</p>
<p><strong>二、部署ChatGPT接口服务</strong></p>
<p>通过步骤一，我们注册了免费的国外服务器，并创建了node应用环境，接下来我们需要开始部署ChatGPT的接口服务，这里我们使用koa搭建一个简单的服务，首先创建基础项目结构，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├── app.js  </span><br><span class="line">	├── node_modules  </span><br><span class="line">	├── package-lock.json  </span><br><span class="line">	├── package.json  </span><br><span class="line">	├── public  </span><br><span class="line">	├── routes  </span><br><span class="line">	│   └── gpt.js  </span><br><span class="line">	├── utils  </span><br><span class="line">	│   └── ai.js  </span><br><span class="line">	└── views</span><br></pre></td></tr></table></figure>

<p>app.js的代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"><span class="keyword">const</span> json = <span class="built_in">require</span>(<span class="string">&#x27;koa-json&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> onerror = <span class="built_in">require</span>(<span class="string">&#x27;koa-onerror&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyparser = <span class="built_in">require</span>(<span class="string">&#x27;koa-bodyparser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> koaBody = <span class="built_in">require</span>(<span class="string">&#x27;koa-body&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> gpt = <span class="built_in">require</span>(<span class="string">&#x27;./routes/gpt&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">onerror</span>(app);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">async</span> (ctx, next)=&gt; &#123;  </span><br><span class="line">    ctx.<span class="title function_">set</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">    ctx.<span class="title function_">set</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;Content-Type&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">koaBody</span>(&#123;  </span><br><span class="line">    <span class="attr">multipart</span>: <span class="literal">true</span>,  </span><br><span class="line">    <span class="attr">formidable</span>: &#123;</span><br><span class="line">        <span class="attr">maxFieldsSize</span>: <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>,</span><br><span class="line">        <span class="attr">multipart</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyparser</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(gpt.<span class="title function_">routes</span>(), gpt.<span class="title function_">allowedMethods</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(app.<span class="title function_">callback</span>());</span><br><span class="line">server.<span class="title function_">listen</span>(process.<span class="property">env</span>.<span class="property">PORT</span>);</span><br></pre></td></tr></table></figure>

<p>gpt.js代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>)();</span><br><span class="line"><span class="keyword">const</span> &#123; getData &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/ai&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">prefix</span>(<span class="string">&#x27;/gpt&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">all</span>(<span class="string">&#x27;/chat&#x27;</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;  </span><br><span class="line">    <span class="keyword">const</span> &#123; q = <span class="string">&#x27;&#x27;</span> &#125; = ctx.<span class="property">query</span>;  </span><br><span class="line">    <span class="keyword">if</span> (!q.<span class="title function_">trim</span>()) &#123;     </span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">body</span> = <span class="string">&#x27;您想问啥呢？&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="title function_">getData</span>(q);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>对于getData方法的实现，这里图方便使用request库（目前已废弃）来发起请求，大家可以根据自己的习惯更改，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getData</span>(<span class="params">prompt</span>) &#123;    </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;        </span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;https://api.openai.com/v1/completions&#x27;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">body</span>: &#123;</span><br><span class="line">            prompt,</span><br><span class="line">            <span class="attr">max_tokens</span>: <span class="number">2048</span>,</span><br><span class="line">            <span class="attr">model</span>: <span class="string">&#x27;text-davinci-003&#x27;</span>        &#125;,</span><br><span class="line">        <span class="attr">json</span>: <span class="literal">true</span>, </span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">            <span class="title class_">Authorization</span>: <span class="string">&#x27;OPENAI_TOKEN&#x27;</span>       </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    getData,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>将所有的源码连同node_modules一起上传到www目录下，这里稍微有点慢，可以尝试压缩后再上传，然后在线解压，</p>
<p><img src="/./../img/640134123-1688378776316-60.png" alt="图片"></p>
<p>等待所有文件上传完毕后，通过“对外地址&#x2F;gpt&#x2F;chat?q&#x3D;你的问题”即可访问我们部署的ChatGPT服务。</p>
<p><strong>三、问题总结</strong></p>
<p>1、hostbuddy服务器的免费试用时长目前是60天即2个月，这个门槛比较低，到期前找个邮箱重新注册即可继续使用，当然也可以选择其他的厂商，比如LAF，免费时长是一个月，需要手机号注册，具体可参考：<a href="https://mp.weixin.qq.com/s?__biz=Mzg5NTczMjAxMg==&mid=2247484797&idx=1&sn=de3d62aa80284e08f658a1421c490991&scene=21#wechat_redirect">用Laf云平台，两步将ChatGPT接入微信公众号(含代码)</a></p>
<p>2、注册hostbuddy一个IP只可注册一次，如果遇到访问注册页显示已经注册的情况，可以选择重启路由器换IP或者使用代理。</p>
<p>3、如果使用代理注册hostbuddy需要注意并不是所有的地区都可以注册免费试用账号，具体支持的地区需要自测，我只发现日本是不行的。</p>
<p>4、hostbuddy服务器目前默认的node版本是v18x，如果需要自定义node版本，可参考：<a href="https://www.hostbuddy.com/support/kb/a2205/how-to-custom-nodejs-version-with-our-server.aspx">https://www.hostbuddy.com/support/kb/a2205/how-to-custom-nodejs-version-with-our-server.aspx</a></p>
<p>5、在更新程序文件时，如遇到代码不更新的情况，需要重新保存入口文件比如app.js，重新上传即可。</p>
<p>6、如果网站无法访问，又没有给出具体的错误信息，可以到FTP网站目录如www下根据访问时间查看iisnode目录下对应的txt文件获得报错信息。</p>
<p><strong>四、结语</strong></p>
<p>如需下载本文所涉及的源码及素材包，请在关注公众号后发送：<strong>gpt</strong></p>
]]></content>
      
        <categories>
            
            <category> chatgpt </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ChatGPT </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[有趣的chrom插件]]></title>
      <url>/2023/06/20/%E6%9C%89%E8%B6%A3%E7%9A%84chrom%E6%8F%92%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>推荐一位国外全栈开发者大神：Alyssa，在 Github 上有 5.34K 的关注者。她是一名全栈开发者、Sonuum 公司的创始人。</p>
<p>被 Maker Mag 评为 2018 最佳女性 Maker，并两次入围 Product Hunt Maker of the Year 决赛。</p>
<p>注：Product Hunt 是国外的一个寻找好产品的网站，开发者或者开发团队可以把自己开发的产品发布到网站，与社区的用户一起讨论。本文中推荐 4 个有趣的开源项目，都是由开发者 Alyssa 完成。</p>
<p><img src="/./../img/651" alt="图片"></p>
<p>本期推荐开源项目目录：</p>
<p>\1. 适用于 Chrome 的屏幕录制工具</p>
<p>\2. 强大的浏览器插件</p>
<p>\3. 实时协作的地图工具</p>
<p>\4. 创建漂亮的流程图</p>
<hr>
<h1 id="01"><a href="#01" class="headerlink" title="01"></a>01</h1><p><strong>适用于 Chrome 的屏幕录制工具</strong></p>
<p>适用于 Chrome 的最强大的屏幕录像机和注释工具，使用该插件你可以录制你的屏幕和并且在屏幕任意位置进行绘画、添加文本、添加箭头，同时还可以录制你的电脑音频。</p>
<p>录制完成，你可以对录制的视频片段进行修剪，导出为 MP4、Gif 并且一键保存到谷歌云盘。该开源项目的地址和使用的库的地址都放在了下面。</p>
<p>编程语言：Javascript</p>
<p>开源地址：<a href="https://github.com/alyssaxuu/screenity">https://github.com/alyssaxuu/screenity</a></p>
<p>相关开源组件地址：</p>
<p>用于交互式文本和箭头：<a href="https://github.com/fabricjs/fabric.js">https://github.com/fabricjs/fabric.js</a><br>下拉菜单的开源组件：<a href="https://github.com/hernansartorio/jquery-nice-select">https://github.com/hernansartorio/jquery-nice-select</a><br>用于修剪&#x2F;删除录音部分的范围组件：<a href="https://github.com/leongersen/noUiSlider">https://github.com/leongersen/noUiSlider</a><br>颜色选择块：<a href="https://github.com/Simonwep/pickr">https://github.com/Simonwep/pickr</a><br>用于在录制时异步保存视频：<a href="https://github.com/jimmywarting/StreamSaver.js">https://github.com/jimmywarting/StreamSaver.js</a><br>使下载的视频可搜索的开源组件：<a href="https://github.com/yusitnikov/fix-webm-duration">https://github.com/yusitnikov/fix-webm-duration</a></p>
<p><img src="/./../img/652" alt="图片"></p>
<h1 id="02"><a href="#02" class="headerlink" title="02"></a>02</h1><p><strong>强大的浏览器插件</strong></p>
<p>使用开源项目 Omni 可以帮助你更专业的管理你的浏览器， Omni 提供了一个简单界面，在界面中你只需要使用简单的命令就能管理选项卡、书签、浏览器历史记录、执行各种操作等等。</p>
<p>你可以方便的搜索、浏览管理标签、快速搜索浏览历史记录、与 Notion、Figma、稳定集成，同时好包含更多高级设置。</p>
<p>编程语言：JavaScript</p>
<p>开源地址：<a href="https://github.com/alyssaxuu/omni">https://github.com/alyssaxuu/omni</a></p>
<p><img src="/./../img/653" alt="图片"></p>
<p><img src="/./../img/654" alt="图片"></p>
<p><img src="/./../img/655" alt="图片"></p>
<h1 id="03"><a href="#03" class="headerlink" title="03"></a>03</h1><p><strong>实时协作的地图工具</strong></p>
<p>Mapus 是一种在地图上协作探索和注释的工具，开源一年获得了近 3K 的 Star。使用该开源项目你可以在地图上绘制、标记、画出区域等等，想当于在普通的地图上增加了实时协作的功能。</p>
<p>通过实时协作，你可以与其他用户同步计划和行程；你能使用画笔或者箭头在地图上标记和注释；还可以创建一些标记，方便快速定位标注地图上的位置，同样可以把地图数据导出。</p>
<p>编程语言：JavaScript、CSS、HTML</p>
<p>开源地址：<a href="https://github.com/alyssaxuu/mapus">https://github.com/alyssaxuu/mapus</a></p>
<p><img src="/./../img/656" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruyZm3e5tzWtkJfR1EqvtZGmtyaSdznmJHgJDqiclRG4AN4CicTOicwLcPKxTX8vOiam49ribuqHUnLVfaA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><img src="/./../img/657" alt="图片"></p>
<h1 id="04"><a href="#04" class="headerlink" title="04"></a>04</h1><p><strong>创建漂亮的流程图</strong></p>
<p>这是一个轻量级的 JavaScript 库 近1W人 Star，通过该 Flowy 你能在你的应用中创建漂亮的流程图，使用步骤如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/* 在你的 Web 项目引入 flowy.min.js 和 flow.min.css  */</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/alyssaxuu/flowy/flowy.min.css&quot;&gt; </span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/alyssaxuu/flowy/flowy.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">/* 引入 create-flowy 类就能创建可拖动的 block   */</span><br><span class="line">&lt;div class=&quot;create-flowy&quot;&gt;The block to be dragged&lt;/div&gt;</span><br><span class="line">&lt;div id=&quot;canvas&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>更详细的教程可以参考该项目的 Readme 文件：</p>
<p><img src="/./../img/658" alt="图片"></p>
<p>开源地址：<a href="https://github.com/alyssaxuu/flowy">https://github.com/alyssaxuu/flowy</a></p>
<p><img src="/./../img/659" alt="图片"></p>
]]></content>
      
        
        <tags>
            
            <tag> 插件 </tag>
            
            <tag> chrom </tag>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[申请永久免费域名并绑定到个人网站]]></title>
      <url>/2023/06/20/%E7%94%B3%E8%AF%B7%E6%B0%B8%E4%B9%85%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E5%B9%B6%E7%BB%91%E5%AE%9A%E5%88%B0%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99/</url>
      <content type="html"><![CDATA[<p><code>eu.org</code>一个从1996开始提供免费域名的组织, 其官网地址是 <a href="https://nic.eu.org/">https://nic.eu.org/</a> ，他帮助学生、爱好者或者非营利组织不用花费购买域名就可能拥有自己的免费域名，虽然 eu.org 网域切确来说这是一个子域名（Subdomain）或者二级域名，但是根据一些网站的资讯，有许多大型互联网公司，像是 Google, Cloudflare, Bing 等厂商都已经将eu.org域名当成是一个顶级网域了。</p>
<p><code>eu.org</code>对个人和组织是免费注册的。</p>
<h1 id="域名申请"><a href="#域名申请" class="headerlink" title="域名申请"></a>域名申请</h1><h3 id="申请地址"><a href="#申请地址" class="headerlink" title="申请地址"></a>申请地址</h3><p>申请地址：<a href="https://nic.eu.org/">https://nic.eu.org/</a></p>
<p>第一次打开你可能会怀疑进错了页面，不用怀疑，他们就是这么简洁的页面。</p>
<p><img src="/./../img/640" alt="图片"></p>
<p>点击 <code>Sign-in or sign-up here!</code> 进入登录页面。</p>
<h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><p>然后点击Register进入注册页面。输入你的基本信息，比如Name，Email等等基本信息，这里不建议填国内的地址信息，你可以进入 <a href="https://www.haoweichi.com/">https://www.haoweichi.com/</a> 网站随机生成一个虚拟英国或者美国地址，会提高通过的概率。</p>
<p><img src="/./../img/641" alt="图片"></p>
<p>注册成功之后点击<code>New Domain</code>申请新的域名，</p>
<p>设置你的域名，eu.org后缀，比如我申请一个新的域名：techxiaofei.eu.org</p>
<p>![图片](data:image&#x2F;svg+xml,%3C%3Fxml version&#x3D;’1.0’ encoding&#x3D;’UTF-8’%3F%3E%3Csvg width&#x3D;’1px’ height&#x3D;’1px’ viewBox&#x3D;’0 0 1 1’ version&#x3D;’1.1’ xmlns&#x3D;’<a href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>‘ xmlns:xlink&#x3D;’<a href="http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg">http://www.w3.org/1999/xlink&#39;%3E%3Ctitle%3E%3C/title%3E%3Cg</a> stroke&#x3D;’none’ stroke-width&#x3D;’1’ fill&#x3D;’none’ fill-rule&#x3D;’evenodd’ fill-opacity&#x3D;’0’%3E%3Cg transform&#x3D;’translate(-249.000000, -126.000000)’ fill&#x3D;’%23FFFFFF’%3E%3Crect x&#x3D;’249’ y&#x3D;’126’ width&#x3D;’1’ height&#x3D;’1’%3E%3C&#x2F;rect%3E%3C&#x2F;g%3E%3C&#x2F;g%3E%3C&#x2F;svg%3E)</p>
<p>最主要的就是NameServers也就是域名解析，也就是我们要用什么域名解析商来解析域名。</p>
<p>![图片](data:image&#x2F;svg+xml,%3C%3Fxml version&#x3D;’1.0’ encoding&#x3D;’UTF-8’%3F%3E%3Csvg width&#x3D;’1px’ height&#x3D;’1px’ viewBox&#x3D;’0 0 1 1’ version&#x3D;’1.1’ xmlns&#x3D;’<a href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>‘ xmlns:xlink&#x3D;’<a href="http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg">http://www.w3.org/1999/xlink&#39;%3E%3Ctitle%3E%3C/title%3E%3Cg</a> stroke&#x3D;’none’ stroke-width&#x3D;’1’ fill&#x3D;’none’ fill-rule&#x3D;’evenodd’ fill-opacity&#x3D;’0’%3E%3Cg transform&#x3D;’translate(-249.000000, -126.000000)’ fill&#x3D;’%23FFFFFF’%3E%3Crect x&#x3D;’249’ y&#x3D;’126’ width&#x3D;’1’ height&#x3D;’1’%3E%3C&#x2F;rect%3E%3C&#x2F;g%3E%3C&#x2F;g%3E%3C&#x2F;svg%3E)</p>
<h3 id="DNSPod"><a href="#DNSPod" class="headerlink" title="DNSPod"></a>DNSPod</h3><p>这里填DNSPod的地址，也就是腾讯云的域名解析商，使用微信扫码登录就可以。<a href="https://www.dnspod.cn/">https://www.dnspod.cn/</a></p>
<p>扫码之后点击右上角<code>管理控制台</code>-&gt;<code>我的域名</code>-&gt;<code>添加域名</code>，添加刚才你申请的域名，也就是<code>techxiaofei.eu.org</code></p>
<p>点击确认，会提示<code>未使用DNSPod</code>，鼠标放上去会显示具体的DNS服务器地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">barlow.dnspod.nethammer.dnspod.net</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/642" alt="图片"></p>
<p>这个DNS服务器就是我们需要在eu.org填写的Name Servers</p>
<h3 id="Name-Servers"><a href="#Name-Servers" class="headerlink" title="Name Servers"></a>Name Servers</h3><p>选择<code>server names</code>，然后填写刚才DNSPod上的两个DNS服务器地址：</p>
<p><img src="/./../img/643" alt="图片"></p>
<p>然后点击Submit后跳转页面显示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---- Servers and domain names check</span><br><span class="line">Getting IP for BARLOW.DNSPOD.NET: 112.80.181.45 1.12.0.4 61.151.180.44 129.211.176.187 120.241.130.98Getting IP for BARLOW.DNSPOD.NET: 2402:4e00:1430:1102:0:9136:2b30:e554Getting IP for HAMMER.DNSPOD.NET: 112.80.181.111 1.12.0.1 117.89.178.184 129.211.176.224 36.155.149.176Getting IP for HAMMER.DNSPOD.NET: 2402:4e00:1020:1264:0:9136:29bc:87f9</span><br><span class="line"></span><br><span class="line">No error, storing for validation...Saved as request 20230326043206-arf-59848</span><br><span class="line">Done</span><br></pre></td></tr></table></figure>

<p>说明你申请成功了，需要等待1到30天，通过会给邮件通知。</p>
<h3 id="申请通过"><a href="#申请通过" class="headerlink" title="申请通过"></a>申请通过</h3><p>我这里等待了大半个月收到邮件通知，这个时候说明你的免费域名已经申请通过了。</p>
<p><img src="/./../img/644" alt="图片"></p>
<p>收到通知之后就可以去DNSPod上添加具体的解析记录绑定到你的个人网站了：</p>
<h1 id="绑定个人网站"><a href="#绑定个人网站" class="headerlink" title="绑定个人网站"></a>绑定个人网站</h1><h3 id="DNSPod记录"><a href="#DNSPod记录" class="headerlink" title="DNSPod记录"></a>DNSPod记录</h3><p>申请通过之后DNSPod记录会从<code>未使用DNSPod</code>变为无记录，就说明域名已经授权使用DNSPod来解析了。只是还没有添加解析记录。</p>
<p><img src="/./../img/645" alt="图片"></p>
<h3 id="绑定域名到Vercel托管平台"><a href="#绑定域名到Vercel托管平台" class="headerlink" title="绑定域名到Vercel托管平台"></a>绑定域名到Vercel托管平台</h3><p>由于我的网站是部署在Vercel托管平台，所以我们需要先回到Vercel来添加域名：</p>
<p>回到你的vercel，点击你的项目-&gt;<code>Settings</code>-&gt;<code>Domains</code></p>
<p>添加你刚申请的域名</p>
<p><img src="/./../img/646" alt="图片"></p>
<p>添加之后会提示你需要域名解析商添加一条A记录。</p>
<p><img src="/./../img/647" alt="图片"></p>
<h3 id="添加一条A记录"><a href="#添加一条A记录" class="headerlink" title="添加一条A记录"></a>添加一条A记录</h3><p>回到DNSPod域名解析商那里添加一条A记录，记录值就是Vercel平台提示的IP地址。</p>
<p><img src="/./../img/648" alt="图片"></p>
<h3 id="添加成功"><a href="#添加成功" class="headerlink" title="添加成功"></a>添加成功</h3><p>回到Verel托管平台，会自动刷新，显示合法配置。</p>
<p><img src="/./../img/649" alt="图片"></p>
<p>然后点击域名后面的跳转链接，直接打开个人网站。</p>
<p><img src="/./../img/650" alt="图片"></p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>希望大家都能早日成功申请到自己的免费域名。</p>
]]></content>
      
        
        <tags>
            
            <tag> 域名 </tag>
            
            <tag> 绑定域名 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[一键部署你的ChatGPT Web网站]]></title>
      <url>/2023/06/20/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E4%BD%A0%E7%9A%84ChatGPT-Web%E7%BD%91%E7%AB%99/</url>
      <content type="html"><![CDATA[<p>想要搭建自己的ChatGPT Web网站，我们只需要两个账号：</p>
<p>1.Github账号 -<a href="https://github.com/2.Vercel%E8%B4%A6%E5%8F%B7">https://github.com/2.Vercel账号</a> -<a href="https://vercel.com/login">https://vercel.com/login</a></p>
<p>其实<code>Vercel</code>账号可以使用Github账号直接登录：</p>
<p><img src="/./../img/image-20230620135811094.png" alt="image-20230620135811094"></p>
<p>所以我们只需要注册一个Github账号即可。</p>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h3 id="1-Github"><a href="#1-Github" class="headerlink" title="1. Github"></a>1. Github</h3><p>我们首先先在<strong>Github</strong>上访问这个地址：<a href="https://github.com/Yidadaa/ChatGPT-Next-Web">https://github.com/Yidadaa/ChatGPT-Next-Web</a></p>
<p>然后点击右上角的<code>Fork</code>也就是克隆，然后点击<code>Create Fork</code>把这个仓库克隆到你的账号下</p>
<p><img src="/./../img/202307031758362.png" alt="图片"></p>
<p>这个时候就会把这个github 仓库克隆到你的个人账号下面。</p>
<h3 id="Vercel"><a href="#Vercel" class="headerlink" title="Vercel"></a>Vercel</h3><p>克隆之后我们去到Vercel平台。<strong>Vercel</strong> 使用刚才的Github账号登录并授权。</p>
<p>我们直接点击<code>Add New-&gt;Project</code>，然后找到我们的<code>ChatGPT-next-web</code>这个Github仓库，点击<code>Import</code>导入</p>
<p><img src="/./../img/640asga" alt="图片"></p>
<p>这个<strong>project name</strong>我们可以随便选，使用默认的即可。</p>
<p>我们唯一要注意的就是这个环境变量，我们需要把ChatGPT的<code>API Key</code>添加进来，然后部署。</p>
<p>这个API Key是为了验证你的身份，需要你有<strong>OpenAI</strong>账号。</p>
<p>![图片](data:image&#x2F;svg+xml,%3C%3Fxml version&#x3D;’1.0’ encoding&#x3D;’UTF-8’%3F%3E%3Csvg width&#x3D;’1px’ height&#x3D;’1px’ viewBox&#x3D;’0 0 1 1’ version&#x3D;’1.1’ xmlns&#x3D;’<a href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>‘ xmlns:xlink&#x3D;’<a href="http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg">http://www.w3.org/1999/xlink&#39;%3E%3Ctitle%3E%3C/title%3E%3Cg</a> stroke&#x3D;’none’ stroke-width&#x3D;’1’ fill&#x3D;’none’ fill-rule&#x3D;’evenodd’ fill-opacity&#x3D;’0’%3E%3Cg transform&#x3D;’translate(-249.000000, -126.000000)’ fill&#x3D;’%23FFFFFF’%3E%3Crect x&#x3D;’249’ y&#x3D;’126’ width&#x3D;’1’ height&#x3D;’1’%3E%3C&#x2F;rect%3E%3C&#x2F;g%3E%3C&#x2F;g%3E%3C&#x2F;svg%3E)</p>
<h3 id="API-key"><a href="#API-key" class="headerlink" title="API key"></a>API key</h3><p>如果你不知道上面的API Key怎么获得，这个非常简单，我们打开openai的平台地址：<a href="https://platform.openai.com/">https://platform.openai.com/</a></p>
<p>登录之后点击右上角的头像，点击<code>Manage Account</code>-&gt;<code>API Keys</code>-&gt;<code>Create New Secret Key</code>, 然后复制下来保存备用。</p>
<p><img src="/./../img/agsdgas" alt="图片"></p>
<h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p>然后回到刚才的部署界面，在刚才的环境变量在<strong>Name</strong>里面输入 <code>OEPNAI_API_KEY</code>，然后<code>Value</code>就输入我们刚才复制的API Key</p>
<p>点击<code>Add</code>添加，然后我们点击<code>Deploy</code>部署。</p>
<p>当然如果你需要你的ChatGPT支持密码访问，可以添加一个新的环境变量，</p>
<h2 id=""><a href="#" class="headerlink" title="- "></a>- </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Name: CODEValue: 你想要设置的密码</span><br></pre></td></tr></table></figure>

<p>这个时候，我们的网站就会需要密码访问</p>
<p>我们点击<strong>Deploy</strong>，可以看到它就开始部署了 我们稍等一会就可以看到我们的网站就能部署成功了。</p>
<p><img src="/./../img/asdga" alt="图片"></p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>我们可以点击就可以进入到我们的ChatGPT 个人网站了。</p>
<p><img src="/./../img/gdfh" alt="图片"></p>
<p>此时Vercel 给我们自动分配了域名，当然这个域名由于某些原因，在国内可能无法访问，你可能需要使用自己的域名。</p>
<p>我们在刚才的部署成功的页面点击右边的<code>Add Domain</code>添加域名，</p>
<p><img src="/./../img/sgdfgv" alt="图片"></p>
<p>然后输入我们的域名，点击添加。我们选择默认的选项， 然后点击添加</p>
<p><img src="/./../img/asdfcx" alt="图片"></p>
<p>添加之后Vercel会提示我们需要添加两条记录，一条是<code>A记录</code>，一条是<code>CNAME记录</code>。</p>
<p><img src="/./../img/vzxcv" alt="图片"></p>
<p>我们进入到我们的域名解析商，这里我使用<code>cloudflare</code>来解析我的域名。</p>
<p>我们在这里点击添加记录：</p>
<p>•首先我们添加A记录，记录类型是<code>A</code>，名称是<code>@</code>，然后ipv4地址就是刚才的ip地址•然后我们再添加一条 CNAME 记录，记录类型是<code>CNAME</code>，名称是<code>www</code>，值是刚才的值</p>
<p><img src="/./../img/xcvz" alt="图片"></p>
<p>现在我们这两条记录，就已经添加成功了</p>
<p>我们再回到我们的 Vercel 托管平台，可以看到，我们的DNS记录已经设置成功了</p>
<p><img src="/./../img/adcxzx" alt="图片"></p>
<p>我们添加成功之后直接点击跳转，用我们自己的域名就可以访问ChatGPT Web网站了。</p>
<p>那我们可以开始在这里和ChatGPT进行聊天了。</p>
<h3 id="角色扮演"><a href="#角色扮演" class="headerlink" title="角色扮演"></a>角色扮演</h3><p>我们也可以让ChatGPT来扮演各种角色，此时ChatGPT的回答会更具有专业性。</p>
<p>我们可以看到这里有非常多的角色，我们来让他帮我们扮演一个职业顾问，点击左下角<code>新的聊天</code>，找到<code>职业顾问</code>点击跳转新的聊天。</p>
<p><img src="/./../img/vzxcvdfh" alt="图片"></p>
<p>然后我们问他问题：<strong>作为一个程序员，我以后的职业生涯应该怎么规划？</strong></p>
<p>点击发送，可以看到作为一个职业顾问，他给我们详细列明了我们有很多职业道路可以选择，然后还给我们的职业生活也做了一些规划。</p>
<p><img src="/./../img/drter" alt="图片"></p>
<p>如果不让它扮演职业顾问，它给的回答是怎么样的呢？</p>
<p><img src="/./../img/rstnner" alt="图片"></p>
<p>可以看到，同样的问题，当我们不让他扮演任何角色的时候，他给我们的答案就相对专业性就没有那么强。</p>
<p>所以角色扮演在专业的问题上，ChatGPT能给到更好的回答，我们可以使用这个来获得更优秀的答案。</p>
<h3 id="密码访问"><a href="#密码访问" class="headerlink" title="密码访问"></a>密码访问</h3><p>同时这个ChatGPT网站也是支持密码访问的，想要支持密码访问非常简单，上面已经告诉你如何添加环境变量。</p>
<p>如果你之前没有添加，这里教你如何再次添加。</p>
<p>点击你的当前项目，找到<code>settings</code>设置项，然后找到左边的<code>Environment Variables</code>也就是环境变量。</p>
<p><img src="/./../img/ascasv" alt="图片"></p>
<p>密码的环境变量的key是<code>CODE</code>，这个值你可以填写你的密码，比如说我填写<strong>techxiaofei</strong>，然后点击保存</p>
<p>现在我们环境已经添加成功了，添加成功之后我们重新编译一下，我们点击redeploy就是重编译。</p>
<p><img src="/./../img/gser4" alt="图片"></p>
<p>重新访问我们的ChatGPT网站，可以看到上面提示：<strong>现在是未授权状态，请点击左下角设置按钮输入访问密码。</strong></p>
<p><img src="/./../img/sgraweg" alt="图片"></p>
<p>我们点击左下角的设置，然后找到访问密码，输入我们的访问密码，就可以正常和ChatGPT对话了。</p>
<p><img src="/./../img/vdagew" alt="图片"></p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这个ChatGPT Web网站可以解决在国内无法正常访问ChatGPT的问题</p>
<p>而且它也不需要云服务器，不需要你购买任何东西，完全免费，任何人都可以轻松一键部署，所以赶紧尝试一下吧。</p>
]]></content>
      
        <categories>
            
            <category> chatgpt </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vercel </tag>
            
            <tag> ChatGPT </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Markdown 书写示例]]></title>
      <url>/2023/06/19/exp/</url>
      <content type="html"><![CDATA[<h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">::: slot module1</span><br><span class="line">this is module1</span><br><span class="line">::::</span><br><span class="line"></span><br><span class="line">::: slot module2</span><br><span class="line">this is module2</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>[[toc]]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[toc]]</span><br></pre></td></tr></table></figure>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><blockquote>
<p>这是一条引用</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; 这是一条引用</span><br></pre></td></tr></table></figure>
<h2 id="自定义容器"><a href="#自定义容器" class="headerlink" title="自定义容器"></a>自定义容器</h2><p>::: info 信息<br>这是一个信息<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: info 信息</span><br><span class="line">这是一个信息</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>

<p>::: tip 告示<br>这是一个提示<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: tip 告示</span><br><span class="line">这是一个提示</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>

<p>::: warning 警告<br>这是一个警告<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: warning 警告</span><br><span class="line">这是一个警告</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>

<p>::: danger STOP<br>危险区域，禁止通行<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: danger STOP</span><br><span class="line">危险区域，禁止通行</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>


<p>::: details 点击查看代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;你好，VuePress！&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">::: details 点击查看代码</span><br><span class="line">```</span><br><span class="line">console.log(&#x27;你好，VuePress！&#x27;)</span><br><span class="line">```</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>

<p>::: v-pre<br><code>&#123;&#123; This will be displayed as-is &#125;&#125;</code><br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: v-pre</span><br><span class="line">`&#123;&#123; This will be displayed as-is &#125;&#125;`</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>

<p>::: center<br>居中文字<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: center</span><br><span class="line">居中文字</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>
<p>::: right<br>居右文字<br>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::: right</span><br><span class="line">居右文字</span><br><span class="line">:::</span><br></pre></td></tr></table></figure>
<h2 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h2><p>我是 &#x3D;&#x3D;高亮&#x3D;&#x3D; 的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我是 ==高亮== 的</span><br></pre></td></tr></table></figure>
<h2 id="代码块行高亮"><a href="#代码块行高亮" class="headerlink" title="代码块行高亮"></a>代码块行高亮</h2><figure class="highlight js"><figcaption><span>&#123;1,3-5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&#x27;Highlighted!&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">``` js &#123;1,3-5&#125;</span><br><span class="line">export default &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;Highlighted!&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```</span><br></pre></td></tr></table></figure>
<p>更多用法参照：<a href="https://v1.vuepress.vuejs.org/zh/guide/markdown.html">https://v1.vuepress.vuejs.org/zh/guide/markdown.html</a></p>
<h2 id="emoji"><a href="#emoji" class="headerlink" title="emoji"></a>emoji</h2><p>:tada:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:tada:</span><br></pre></td></tr></table></figure>
<h2 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h2><ul>
<li><p><input disabled="" type="checkbox"> 
看板娘</p>
</li>
<li><p><input disabled="" type="checkbox"> 
调色板</p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
多语言</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- [ ] 看板娘</span><br><span class="line"></span><br><span class="line">- [ ] 调色板</span><br><span class="line"></span><br><span class="line">- [x] 多语言</span><br></pre></td></tr></table></figure>
<h2 id="上下标"><a href="#上下标" class="headerlink" title="上下标"></a>上下标</h2><p>19^th^<br>H<del>2</del>O</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">19^th^</span><br><span class="line">H~2~O</span><br></pre></td></tr></table></figure>
<h2 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h2><p>脚注 1 链接<a href="%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E8%84%9A%E6%B3%A8">^first</a>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">脚注 1 链接[^first].</span><br><span class="line"></span><br><span class="line">[^first]: 这是一个脚注</span><br></pre></td></tr></table></figure>
<h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: Start|past:&gt;http://localhost:8080/exp.html[blank]</span><br><span class="line">e=&gt;end: End|future:&gt;http://localhost:8080/exp.html</span><br><span class="line">op1=&gt;operation: My Operation|past</span><br><span class="line">op2=&gt;operation: Stuff|current</span><br><span class="line">sub1=&gt;subroutine: My Subroutine|invalid</span><br><span class="line">cond=&gt;condition: Yes</span><br><span class="line">or No?|approved:&gt;http://localhost:8080/exp.html</span><br><span class="line">c2=&gt;condition: Good idea|rejected</span><br><span class="line">io=&gt;inputoutput: catch something...|future</span><br><span class="line"></span><br><span class="line">st-&gt;op1(right)-&gt;cond</span><br><span class="line">cond(yes, right)-&gt;c2</span><br><span class="line">cond(no)-&gt;sub1(left)-&gt;op1</span><br><span class="line">c2(yes)-&gt;io-&gt;e</span><br><span class="line">c2(no)-&gt;op2-&gt;e</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">```flow</span><br><span class="line">st=&gt;start: Start|past:&gt;http://localhost:8080/exp.html[blank]</span><br><span class="line">e=&gt;end: End|future:&gt;http://localhost:8080/exp.html</span><br><span class="line">op1=&gt;operation: My Operation|past</span><br><span class="line">op2=&gt;operation: Stuff|current</span><br><span class="line">sub1=&gt;subroutine: My Subroutine|invalid</span><br><span class="line">cond=&gt;condition: Yes</span><br><span class="line">or No?|approved:&gt;http://localhost:8080/exp.html</span><br><span class="line">c2=&gt;condition: Good idea|rejected</span><br><span class="line">io=&gt;inputoutput: catch something...|future</span><br><span class="line"></span><br><span class="line">st-&gt;op1(right)-&gt;cond</span><br><span class="line">cond(yes, right)-&gt;c2</span><br><span class="line">cond(no)-&gt;sub1(left)-&gt;op1</span><br><span class="line">c2(yes)-&gt;io-&gt;e</span><br><span class="line">c2(no)-&gt;op2-&gt;e</span><br><span class="line">```</span><br></pre></td></tr></table></figure>


<h2 id="Tex"><a href="#Tex" class="headerlink" title="Tex"></a>Tex</h2><p>Euler’s identity $e^{i\pi}+1&#x3D;0$ is a beautiful formula in $\mathbb{R}^2$.</p>
<p>$$<br>\frac {\partial^r} {\partial \omega^r} \left(\frac {y^{\omega}} {\omega}\right)<br>&#x3D; \left(\frac {y^{\omega}} {\omega}\right) \left{(\log y)^r + \sum_{i&#x3D;1}^r \frac {(-1)^i r \cdots (r-i+1) (\log y)^{r-i}} {\omega^i} \right}<br>$$</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Euler’s identity $e^&#123;i\pi&#125;+1=0$ is a beautiful formula in $\mathbb&#123;R&#125;^2$.</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">\frac &#123;\partial^r&#125; &#123;\partial \omega^r&#125; \left(\frac &#123;y^&#123;\omega&#125;&#125; &#123;\omega&#125;\right)</span><br><span class="line">= \left(\frac &#123;y^&#123;\omega&#125;&#125; &#123;\omega&#125;\right) \left\&#123;(\log y)^r + \sum_&#123;i=1&#125;^r \frac &#123;(-1)^i r \cdots (r-i+1) (\log y)^&#123;r-i&#125;&#125; &#123;\omega^i&#125; \right\&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>

<h2 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h2><p>::: demo 这是 demo 标题</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span>&gt;</span>点我试试<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#hello&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:::</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">::: demo 这是 demo 标题</span><br><span class="line"></span><br><span class="line">```html</span><br><span class="line">&lt;p&gt;&lt;span id=&quot;hello&quot;&gt;点我试试&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">document.querySelector(&quot;#hello&quot;).addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">  alert(&quot;hello world&quot;);</span><br><span class="line">&#125;);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```css</span><br><span class="line">span &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">:::</span><br></pre></td></tr></table></figure>
<p>存在超自然现象，谨慎使用！</p>
<h2 id="常用Front-Matter"><a href="#常用Front-Matter" class="headerlink" title="常用Front Matter"></a>常用Front Matter</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">标题</span></span><br><span class="line"><span class="attr">date:</span> <span class="string">日期</span> <span class="number">2021-03-4</span></span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">JavaScript</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Vue</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ElementUI</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">作者</span></span><br><span class="line"><span class="attr">location:</span> <span class="string">地理位置</span></span><br><span class="line"><span class="attr">layout:</span> <span class="string">模板</span></span><br><span class="line"><span class="attr">meta:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">description</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">seo用页面描述</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">keywords</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">seo用关键词</span></span><br><span class="line"><span class="attr">summary:</span> <span class="string">列表显示文章简述</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">伪静态用生成文章url</span></span><br><span class="line"><span class="attr">metaTitle:</span> <span class="string">网页的title</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">changefreq:</span> <span class="string">monthly</span> [<span class="string">alway|shourly|daily|weekly|monthly|yearly|never</span>]</span><br><span class="line"><span class="attr">styleClass:</span> <span class="string">someClass</span></span><br><span class="line"><span class="attr">comment:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">waiting:</span> <span class="literal">false</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>其他格式 请使用 Typora 编辑器辅助使用<br>或者参照</p>
<p><a href="https://markdown-it.github.io/">https://markdown-it.github.io/</a></p>
<p><a href="https://vuepress-theme-hope.github.io/md-enhance/zh/guide/">https://vuepress-theme-hope.github.io/md-enhance/zh/guide/</a></p>
<p>书写规范，参见</p>
<p><a href="/2021/04/27/docs-regulation/">此处</a></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[记录我的小项目-第一弹]]></title>
      <url>/2023/06/19/%E8%AE%B0%E5%BD%95%E6%88%91%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE-%E7%AC%AC%E4%B8%80%E5%BC%B9/</url>
      <content type="html"><![CDATA[<p>记录我的小项目-第一弹</p>
<h5 id="一、项目起因："><a href="#一、项目起因：" class="headerlink" title="一、项目起因："></a>一、项目起因：</h5><blockquote>
<p>最近一致在琢磨一个有趣的项目，可以涵盖自己的所学知识，运营、技术、产品、销售。最初规划是希望通过chatgpt的Vercel项目免费开发给美术生，Midjourney出一些美图在小红书、抖音上发进行引流，chatGPT做钩子引导公众号，通过公众号做文章软文做转化，小程序做chatgpt活跃,。最后完成产品的售卖。</p>
<p>而后切入到6月高考季，发现社会热点的仍是聚焦志愿填报，而且自己的目标人群也有十分之一是美术生，所幸自己的Excel运用也不错，就想通过Excel做一个高考志愿填报的系统，主要用公式进行志愿分析，用于引流，料想应该不会差。遂进行初期尝试。</p>
</blockquote>
<p><strong>记录工具：</strong><a href="https://kgithub.com/hexojs">hexojs</a>&#x2F;<a href="https://kgithub.com/hexojs/hexo">hexo</a>博客，vercel部署</p>
<p><strong>chatGpt：</strong><a href="https://kgithub.com/Yidadaa">Yidadaa</a>&#x2F;<a href="https://kgithub.com/Yidadaa/ChatGPT-Next-Web">ChatGPT-Next-Web</a>，vercel部署</p>
<p><strong>流程工具：</strong><a href="https://gitee.com/aipaw">aipaw</a> &#x2F; <a href="https://gitee.com/aipaw/dootask">dootask</a>，docker部署</p>
<p><strong>小程序工具：</strong><a href="https://gitee.com/smalle">月星墙</a> &#x2F; <a href="https://gitee.com/smalle/ChatGPT-MP">ChatGPT-MP</a>，（未开发）</p>
<h5 id="二、项目逻辑："><a href="#二、项目逻辑：" class="headerlink" title="二、项目逻辑："></a>二、项目逻辑：</h5><ol>
<li>Midjourney出图，在小红书（美术生栋栋阿）、抖音号（美术生栋栋阿）发，通过简介发布美术生-找我免费领chatGPT。Midjourney教程。引导（美考攻略公众号）</li>
<li>美考攻略账号直播“美术生志愿填报”引导加公众号领取</li>
<li>公众号发布美术生文章和产品软文，菜单发布ChatGPT单日密码，引导加小程序</li>
<li>小程序有chatGPT,内含升序规划和资料包，引导加微信</li>
<li>产品包设计，美术生小班课、直播插画课、美术生找画室产品</li>
</ol>
<p>chatgpt可以涵盖美术生找画室、美术生查成绩、美术生升学规划、美术报志愿等功能。通过小红书、抖音等新媒体渠道进行引流。</p>
<h5 id="三、整体规划："><a href="#三、整体规划：" class="headerlink" title="三、整体规划："></a>三、整体规划：</h5><ol>
<li>小红书、抖音账号注册；公众号注册（6月完成）</li>
<li>完成Midjourney出图。（6月完成）</li>
<li>完成美术生志愿填报系统设计（6月完成）</li>
<li>公众号文章存档（7月完成10篇）</li>
<li>小班课产品营销物料设计（7月完成10篇）</li>
<li>找老师，出课程（待定）</li>
<li>小程序完善（待定）</li>
</ol>
<h5 id="四、当前进展："><a href="#四、当前进展：" class="headerlink" title="四、当前进展："></a>四、当前进展：</h5><ul>
<li><input disabled="" type="checkbox"> 小红书、抖音账号、公众号注册完成(已完成)</li>
<li><input disabled="" type="checkbox"> 美术生志愿填报设计制作中（计划6月29日前完成）</li>
</ul>
<h5 id="五、指标计划："><a href="#五、指标计划：" class="headerlink" title="五、指标计划："></a>五、指标计划：</h5><p>暂未涉及</p>
<p>&#x3D;&#x3D; 当前项目进展：&#x3D;&#x3D;</p>
<p>已经延后</p>
]]></content>
      
        <categories>
            
            <category> 项目日记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 项目集锦 </tag>
            
            <tag> ideas </tag>
            
            <tag> 小爬虫 </tag>
            
            <tag> 高考网站 </tag>
            
            <tag> 志愿填报 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[pandas 使用方法]]></title>
      <url>/2023/06/14/pandas-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>好的，我可以帮你介绍如何使用 Pandas 来读取 Excel 数据并实现追加数据或追加 Sheet。</p>
<p>首先需要安装 Pandas 库，可以使用以下命令进行安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br></pre></td></tr></table></figure>

<p>有了 Pandas 库，就可以通过 <code>read_excel()</code> 方法读取 Excel 文件了。假设我们有一个名为 <code>data.xlsx</code> 的 Excel 文件，可以使用以下代码读取其中的 Sheet1 中的数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<p>其中 <code>sheet_name</code> 参数可以用来指定要读取的 Sheet 名称或 Sheet 的下标。</p>
<p>接下来可以使用 Pandas 提供的方法往 Excel 中追加数据。假设我们有一个名为 <code>new_data.xlsx</code> 的 Excel 文件，要将数据追加到其中的 Sheet1，可以使用以下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取原有数据</span></span><br><span class="line">df1 = pd.read_excel(<span class="string">&#x27;new_data.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 待追加的新数据</span></span><br><span class="line">data_to_append = &#123;<span class="string">&#x27;Column1&#x27;</span>: [<span class="string">&#x27;New value 1&#x27;</span>, <span class="string">&#x27;New value 2&#x27;</span>],</span><br><span class="line">                  <span class="string">&#x27;Column2&#x27;</span>: [<span class="string">&#x27;New value 3&#x27;</span>, <span class="string">&#x27;New value 4&#x27;</span>]&#125;</span><br><span class="line">df2 = pd.DataFrame(data=data_to_append)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新数据追加到原有数据后面</span></span><br><span class="line">df = pd.concat([df1, df2], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新数据写入 Excel</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">&#x27;new_data.xlsx&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    df.to_excel(writer, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>以上代码中，我们首先使用 <code>read_excel()</code> 方法读取名为 <code>new_data.xlsx</code> 的 Excel 文件中的 Sheet1 数据，然后创建一个包含新数据的数据帧 <code>df2</code>，接着使用 <code>concat()</code> 方法将新数据追加到原有数据后面，最后使用 <code>ExcelWriter()</code> 创建一个 ExcelWriter 对象，并使用 <code>to_excel()</code> 方法将数据写入 Excel 文件中的 Sheet1。</p>
<p>如果要新增一个 Sheet，可以使用以下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 Excel 文件</span></span><br><span class="line">df1 = pd.read_excel(<span class="string">&#x27;new_data.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 待追加的新数据</span></span><br><span class="line">data_to_append = &#123;<span class="string">&#x27;Column1&#x27;</span>: [<span class="string">&#x27;New value 1&#x27;</span>, <span class="string">&#x27;New value 2&#x27;</span>],</span><br><span class="line">                  <span class="string">&#x27;Column2&#x27;</span>: [<span class="string">&#x27;New value 3&#x27;</span>, <span class="string">&#x27;New value 4&#x27;</span>]&#125;</span><br><span class="line">df2 = pd.DataFrame(data=data_to_append)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新数据写入 Excel 中的新 Sheet 中</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">&#x27;new_data.xlsx&#x27;</span>, engine=<span class="string">&#x27;openpyxl&#x27;</span>, mode=<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    df2.to_excel(writer, sheet_name=<span class="string">&#x27;New Sheet&#x27;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>以上代码中，我们使用 <code>read_excel()</code> 方法读取名为 <code>new_data.xlsx</code> 的 Excel 文件中的所有数据，接着创建一个包含新数据的数据帧 <code>df2</code>，最后使用 <code>ExcelWriter()</code> 创建一个 ExcelWriter 对象，并使用 <code>to_excel()</code> 方法将新数据写入 Excel 文件中的新 Sheet 中。请注意，我们在 <code>ExcelWriter()</code> 中指定了 <code>engine</code> 为 <code>openpyxl</code>，并将 <code>mode</code> 参数设置为 <code>a</code>，这样可以以追加模式打开 Excel 文件。</p>
]]></content>
      
        
        <tags>
            
            <tag> pandas </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[高考志愿网JS逆向]]></title>
      <url>/2023/06/14/%E9%AB%98%E8%80%83%E5%BF%97%E6%84%BF%E7%BD%91JS%E9%80%86%E5%90%91/</url>
      <content type="html"><![CDATA[<p>起因：最近想出一个高考志愿填报的excel系统，想先从网上拿一些资源，最开始的设计是希望从网站上找到近5年的报考指南PDF，然后写代码OCR扫描PDF，摘取关键数据，后发现网站没有PDF,于是告吹。后来就找寻网站，看看有没有我想要的数据，于是找到了”掌上高考“，发现有一些数据是想要的。（其实公司内有一个高考志愿网站，草率了）</p>
<p>处理数据：</p>
<h4 id="第一步：打开开发者工具"><a href="#第一步：打开开发者工具" class="headerlink" title="第一步：打开开发者工具"></a>第一步：打开开发者工具</h4><p>找到对应的数据文件</p>
<p><img src="/./../img/image-202306191342401592.png" alt="image-20230619134240159"></p>
<h4 id="第二步：分析payload"><a href="#第二步：分析payload" class="headerlink" title="第二步：分析payload"></a>第二步：分析payload</h4><p>发现是一个POST请求，需要给他的服务器发送数据，再分析payload，发现里面有要发送的数据，里面有个signsafe（估计是个加密数据）看来必须要逆向才行了</p>
<p>后来发现这个网站做逆向纯属脱裤子放屁了。（既然可以用GET请求得到数据，signsafe就是个摆设）不过正好可以学习一下如何逆向。</p>
<p><img src="/./../img/image-20230619134459860.png" alt="image-20230619134459860"></p>
<p><img src="/./../img/image-20230619134408130.png" alt="image-20230619134408130"></p>
<h4 id="第三步：用search搜索一下signsafe（这个需要用H5模式）"><a href="#第三步：用search搜索一下signsafe（这个需要用H5模式）" class="headerlink" title="第三步：用search搜索一下signsafe（这个需要用H5模式）"></a>第三步：用search搜索一下signsafe（这个需要用H5模式）</h4><p>发现了一堆数据，但是能用的就是第一个</p>
<p><img src="/./../img/image-20230620084226083.png" alt="image-20230620084226083"></p>
<h4 id="第四步：分析数据"><a href="#第四步：分析数据" class="headerlink" title="第四步：分析数据"></a>第四步：分析数据</h4><p>通过上下文判断是用的Hmac sha1加密，找到了signsafe</p>
<p><img src="/./../img/image-20230620084326175.png" alt="image-20230620084326175"></p>
<h4 id="第五步：找到文件，用source打断点试试"><a href="#第五步：找到文件，用source打断点试试" class="headerlink" title="第五步：找到文件，用source打断点试试"></a>第五步：找到文件，用source打断点试试</h4><p>根据文件夹的headers找到数据文件夹<img src="/./../img/image-20230619141030125.png" alt="image-20230619141030125"></p>
<p><img src="/./../img/image-20230620084943417.png" alt="image-20230620084943417"></p>
<p>经过断点运行，多试了几次，发现就是这个代码。</p>
<p>这是一个加密的方法，所有的singsafe都走这一个方法，断点可以走第二遍，就能出现我们想要的safe</p>
<p>具体的加密逻辑是这样的：首先获取url（包括传递的数据），然后去掉<code>https:\\</code>,进行sha1加密，密钥是D23ABC@#56,加密后再进行Base64加密，再将加密的数据用MD5进行加密。最后进行拼接。</p>
<h4 id="代码实现："><a href="#代码实现：" class="headerlink" title="代码实现："></a>代码实现：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> common</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> fake_useragent <span class="keyword">import</span> UserAgent</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将已知信息汇总</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">StringConcatenation</span>(<span class="params">url: <span class="built_in">str</span>, p: <span class="built_in">int</span>, n=<span class="literal">None</span></span>) -&gt;<span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;signsafe&#x27;</span> <span class="keyword">in</span> common.data:</span><br><span class="line">            common.data.pop(<span class="string">&#x27;signsafe&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="literal">None</span>:</span><br><span class="line">            common.data[<span class="string">&#x27;page&#x27;</span>] = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            common.data[<span class="string">&#x27;page&#x27;</span>] = i + n</span><br><span class="line">        <span class="comment"># 将对象作为参数构建URL</span></span><br><span class="line">        <span class="comment"># print(common.data[&#x27;page&#x27;])</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;已完成：&#x27;</span>, i, <span class="string">&#x27;当前页数:&#x27;</span>, common.data[<span class="string">&#x27;page&#x27;</span>])</span><br><span class="line">        params = urllib.parse.urlencode(common.data)</span><br><span class="line">        params = urllib.parse.unquote(params)</span><br><span class="line">        url_new = url + <span class="string">&#x27;?&#x27;</span> + params</span><br><span class="line">        <span class="comment"># 构建加密信息</span></span><br><span class="line">        msg = url_new.replace(<span class="string">&#x27;https://&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        Encrypt(msg)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将信息加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">msg</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 基础信息</span></span><br><span class="line">    key = <span class="string">&#x27;D23ABC@#56&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    msg = msg</span><br><span class="line">    <span class="comment"># print(msg)</span></span><br><span class="line">    <span class="comment"># hmac SHA1加密</span></span><br><span class="line">    h = hmac.new(key, msg.encode(<span class="string">&#x27;utf-8&#x27;</span>), hashlib.sha1).digest()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># base64 加密</span></span><br><span class="line">    b = base64.b64encode(h)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># md5 加密</span></span><br><span class="line">    m = hashlib.md5(b)</span><br><span class="line">    m = m.hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    common.data[<span class="string">&#x27;signsafe&#x27;</span>] = m</span><br><span class="line">    <span class="comment"># RequestsHttp()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 做请求</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RequestsHttp</span>(<span class="params">medth</span>):</span><br><span class="line">    ua = UserAgent()</span><br><span class="line">    useragent = ua.random</span><br><span class="line">    common.headers[<span class="string">&#x27;User-Agent&#x27;</span>] = useragent</span><br><span class="line">    ips = proxies_ip()</span><br><span class="line">    proxies = &#123;</span><br><span class="line">    <span class="string">&#x27;HTTP&#x27;</span>: ips,</span><br><span class="line">    <span class="string">&#x27;HTTPS&#x27;</span>: ips</span><br><span class="line">&#125;</span><br><span class="line">    <span class="built_in">print</span>(ips)</span><br><span class="line">    <span class="keyword">if</span> medth == <span class="string">&#x27;post&#x27;</span>:</span><br><span class="line">        <span class="comment"># 构建URL</span></span><br><span class="line">        res = requests.post(url=common.urls[<span class="string">&#x27;url&#x27;</span>], headers=common.headers,data=common.data)</span><br><span class="line"></span><br><span class="line">        res = res.content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        json_str = json.loads(res)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;school_all2.json3&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span> ) <span class="keyword">as</span> f:</span><br><span class="line">            json.dump(json_str, f, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        </span><br><span class="line">        res = requests.get(url=common.urls[<span class="string">&#x27;url&#x27;</span>],headers=common.headers, proxies=proxies, verify=<span class="literal">False</span>)</span><br><span class="line">        res = res.content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        json_str = json.loads(res)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;spictial_school4.json&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">            json.dump(json_str, f, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">    <span class="comment"># StringConcatenation(common.urls[&#x27;url&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxies_ip</span>():</span><br><span class="line"></span><br><span class="line">    res = requests.get(url=url).text</span><br><span class="line"><span class="comment"># 判断高匿代理</span></span><br><span class="line">    url2 = <span class="string">&#x27;http://example.com&#x27;</span></span><br><span class="line">    ips = res</span><br><span class="line">    <span class="built_in">print</span>(ips)</span><br><span class="line">    proxies = &#123;</span><br><span class="line">        <span class="string">&#x27;http&#x27;</span>: <span class="string">f&#x27;http://<span class="subst">&#123;ips&#125;</span>&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https&#x27;</span>: <span class="string">f&#x27;https://<span class="subst">&#123;ips&#125;</span>&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url2, proxies=proxies, timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span> <span class="keyword">in</span> response.headers:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Proxy <span class="subst">&#123;ips&#125;</span> 是高匿代理!&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(ips)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Proxy <span class="subst">&#123;ips&#125;</span> is not high anonymity.&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;出现异常&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        <span class="comment"># common.urls[&#x27;url&#x27;] = &#x27;https://api.eol.cn/gh5/api&#x27;</span></span><br><span class="line">    <span class="comment"># StringConcatenation(common.urls[&#x27;url&#x27;], 10, 230)</span></span><br></pre></td></tr></table></figure>

]]></content>
      
        
        <tags>
            
            <tag> 高考网站 </tag>
            
            <tag> 逆向 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[搭建一个Hexo博客并用vercel部署]]></title>
      <url>/2023/05/31/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E5%8D%9A%E5%AE%A2%E5%B9%B6%E7%94%A8vercel%E9%83%A8%E7%BD%B2%20(2)/</url>
      <content type="html"><![CDATA[<p>Hexo 是一款基于Node.js的静态博客生成器，具有简单易用、快速高效、丰富主题、插件支持等特点，适合用于个人博客、技术文档、个人网站等场景。而且基于 markdown 编写起来非常顺畅，个人非常喜欢这个博客。这次下定决心搭建一个 Hexo 博客来实现我日常分享的一个小博客网站。</p>
<h5 id="前置准备"><a href="#前置准备" class="headerlink" title="前置准备"></a>前置准备</h5><ol>
<li>一台 windows 笔记本电脑，当然 mac 电脑也是没问题的，即使 Linux 电脑也是可以的。</li>
<li>Git工具: Git (git-scm.com)</li>
<li>Node+ Npm工具：Node.js (nodejs.org)</li>
<li>准备好 Hexo 博客程序： <a href="https://hexo.io/">https://hexo.io/</a></li>
<li>创建一个 Git 仓库</li>
<li>注册一个 vercel 账号(如果有自己的服务器或者不适用 vercel 可以不用管这一步)：<a href="https://vercel.com/">https://vercel.com/</a></li>
<li>准备一个域名(如果不需要独立域名可以略过这一步)</li>
<li>hexo 本地图片部署</li>
</ol>
<h5 id="正式开始"><a href="#正式开始" class="headerlink" title="正式开始"></a>正式开始</h5><h6 id="安装-Hexo-工具"><a href="#安装-Hexo-工具" class="headerlink" title="安装 Hexo 工具"></a>安装 Hexo 工具</h6><p>上面的 GIT和 Node在百度或者谷歌上已经有很多相关专业的教程，这里就不详细讲解这块的知识了。一般来说到官网上下载完毕直接下一步下一步即可。我们先来全局安装一个 Hexo 工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure>


<h6 id="创建-hexo-本地博客程序"><a href="#创建-hexo-本地博客程序" class="headerlink" title="创建 hexo 本地博客程序"></a>创建 hexo 本地博客程序</h6><p>安装完成之后我们就可以使用 hexo 的工具来创建博客了。在电脑上创建一个目录并进入该目录，我起名叫做 javier-blog，刚才我们安装过 Git 工具这时候就派上用场了。在该目录内右键找到 Git Bash Here 点击打开一个 Git的命令行窗口或者你可以使用其他的命令行工具。执行以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo init </span><br><span class="line"></span><br><span class="line"># 下面是在执行上面的命令之后的结果</span><br><span class="line"></span><br><span class="line">INFO  Cloning hexo-starter https://github.com/hexojs/hexo-starter.git</span><br><span class="line">INFO  Install dependencies</span><br><span class="line">INFO  Start blogging with Hexo!</span><br></pre></td></tr></table></figure>


<h6 id="启动-hexo-本地服务"><a href="#启动-hexo-本地服务" class="headerlink" title="启动 hexo 本地服务"></a>启动 hexo 本地服务</h6><p>安装完成 hexo程序直接执行 hexo s 命令就可以打开 hexo 的本地服务。在命令行上会显示启动后的服务地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO  Validating config</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>


<p><img src="/./../img/image-20230530180853849.png" alt="image-20230530180853849"></p>
<p>以上就正式搭建完成 hexo 的博客程序了。</p>
<h5 id="修改博客的基本信息"><a href="#修改博客的基本信息" class="headerlink" title="修改博客的基本信息"></a>修改博客的基本信息</h5><p>修改 博客的标题，副标题，描述，语言时区等信息</p>
<p><img src="/../img/cf60858892fa440482540f548322cbfc.png" alt="../img/"></p>
<p>修改博客地址</p>
<p><img src="/../img/5dce8878e1fd42228974ee532b328a31.png" alt="5dce8878e1fd42228974ee532b328a31"></p>
<p>创建 github 仓库<br>打开 <a href="https://github.com/">https://github.com/</a> 创建一个仓库用来存储我们的部署程序,创建后是这个样子的。</p>
<p><img src="/../img/87e34403497b4e8092b8e234b7d154aa.png" alt="../img/"></p>
<p><img src="/../img/2dce5d421d4a45ae8b2628b405f00c85.png" alt="../img/"></p>
<h5 id="同步本地-Hexo-部署页面到-github-中"><a href="#同步本地-Hexo-部署页面到-github-中" class="headerlink" title="同步本地 Hexo 部署页面到 github 中"></a>同步本地 Hexo 部署页面到 github 中</h5><h5 id="初始化-git-项目"><a href="#初始化-git-项目" class="headerlink" title="初始化 git 项目"></a>初始化 git 项目</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin https://github.com/runbrick/javier-blog.git</span><br></pre></td></tr></table></figure>


<p>打开本地 **hexo **项目目录并执行下面的命令,用来安装 git 的部署组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>安装之后在项目目录中找到<code>**_config.yml **</code>修改 deploy 参数</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy<span class="punctuation">:</span></span><br><span class="line">  type<span class="punctuation">:</span> &#x27;git&#x27;</span><br><span class="line">  repo<span class="punctuation">:</span> &#x27;https<span class="punctuation">:</span><span class="comment">//github.com/runbrick/javier-blog.git&#x27;</span></span><br><span class="line">  branch<span class="punctuation">:</span> &#x27;master&#x27;</span><br></pre></td></tr></table></figure>


<p>执行 <code>hexo g</code> 然后执行 <code>hexo d </code>将静态页面部署到 <strong>github</strong> 上，是这个样子的。</p>
<p><img src="/../img/1ee6f73b701249a483c8022e90aa6d6d-1685510451300-24.png" alt="../img/"></p>
<h5 id="将项目部署到-vercel-上"><a href="#将项目部署到-vercel-上" class="headerlink" title="将项目部署到 vercel 上"></a>将项目部署到 vercel 上</h5><p>如果不需要部署到 vercel 上此步可以略过</p>
<p>在 **dashboard **上 选择 <strong>Create a New Project</strong></p>
<p><img src="/../img/54ae8c862963400ea1c2b86c0bec2e79.png" alt="../img/"></p>
<p>在关联的 **github **账户中，找到刚才的博客仓库，选择 import</p>
<p><img src="/../img/6a5b756f46bb4e3fb46a5d93bb32c5ca.png" alt="../img/"></p>
<p>进入部署页面选择 deploy</p>
<p><img src="/../img/d3f01706b7e84ac19d017b12b45cf23b.png" alt="../img/"></p>
<p>生成之后点击 Continue to Dashboard</p>
<p><img src="/../img/83a40d63337d4c02a6ac9d7d8a336ca6.png" alt="../img/"></p>
<p>点击 Visit 就可以看到刚刚生成的博客程序了</p>
<p><img src="/../img/73fea79fe1634cf897df435520360cc0.png" alt="../img/"></p>
<p>将项目资源文件放入同一个仓库中<br>在命令行创建一个新的分支并切换过去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b source</span><br></pre></td></tr></table></figure>


<p>提交代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git push origin source</span><br></pre></td></tr></table></figure>

<p>常用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;name&quot;       # 新建文章</span><br><span class="line">hexo new page &quot;name&quot;  # 新建页面</span><br><span class="line">hexo g                # 生成页面</span><br><span class="line">hexo d                # 部署</span><br><span class="line">hexo g -d             # 生成页面并部署</span><br><span class="line">hexo s                # 本地预览</span><br><span class="line">hexo clean            # 清除缓存和已生成的静态文件</span><br><span class="line">hexo help             # 帮助</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> github </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vervel </tag>
            
            <tag> hexo </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
